<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Content-Centric Networking in Java: org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Content-Centric Networking in Java
   &#160;<span id="projectnumber">0.8.2</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="#pac-static-methods">Static Package Functions</a>  </div>
  <div class="headertitle">
<div class="title">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator" -->
<p>Wrap BouncyCastle's X.509 certificate generator in a slightly more user-friendly way.  
 <a href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#details">More...</a></p>

<p><a href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#aaa6527537d183b50258549d54b566da8">MinimalCertificateGenerator</a> (String subjectDN, PublicKey subjectPublicKey, X509Certificate issuerCertificate, long duration, boolean isCA, Integer chainLength, boolean allUsage)  throws CertificateEncodingException, IOException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Certificate issued under an existing CA.  <a href="#aaa6527537d183b50258549d54b566da8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a9d5ee469a0c04fd1ee53b046fc7a3e1a">MinimalCertificateGenerator</a> (String subjectDN, PublicKey subjectPublicKey, long duration, boolean isCA, boolean allUsage)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Self-signed certificate (which may or may not be a CA).  <a href="#a9d5ee469a0c04fd1ee53b046fc7a3e1a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a5e45691c1547c2af204ca73655417c87">MinimalCertificateGenerator</a> (String subjectDN, PublicKey subjectPublicKey, X500Principal issuerDN, long duration, boolean isCA, Integer chainLength, boolean allUsage)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Basic common path.  <a href="#a5e45691c1547c2af204ca73655417c87"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad9b1469aafb2d4823c497721ac422819">setServerAuthenticationUsage</a> (String serverDNSName)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Both adds the server authentication OID to the EKU extension, and adds the DNS name to the subject alt name extension (not marked critical).  <a href="#ad9b1469aafb2d4823c497721ac422819"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a857850c776fd13ffc1d0154a7f3347af"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::setClientAuthenticationUsage" ref="a857850c776fd13ffc1d0154a7f3347af" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a857850c776fd13ffc1d0154a7f3347af">setClientAuthenticationUsage</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds client authentication as a usage for this certificate. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad090c4fe400a5012499fb137040f25af">setSecureEmailUsage</a> (String subjectEmailAddress)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Both adds the secure email OID to the EKU extension, and adds the email address to the subject alt name extension (not marked critical).  <a href="#ad090c4fe400a5012499fb137040f25af"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#aa10dd7a876e769ac0bd5fca7fc12fdba">setIPSecUsage</a> (String ipAddress)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds ip address to subjectAltName and IPSec usage to EKU.  <a href="#aa10dd7a876e769ac0bd5fca7fc12fdba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a68f3d5a974dd96ae04405527d0930055"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::setExtendedKeyUsage" ref="a68f3d5a974dd96ae04405527d0930055" args="(String usageOID)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>setExtendedKeyUsage</b> (String usageOID)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7f5ac992bf8b5e1c3512d666417d99f8"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::addSubjectAltName" ref="a7f5ac992bf8b5e1c3512d666417d99f8" args="(URI subjectURI)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>addSubjectAltName</b> (URI subjectURI)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a0316e8dbddc7c37d9cf0652c5c9839c4">addAuthorityName</a> (URI authorityName)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Add additional <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_authority_key_identifier.html" title="Reimplementation of BouncyCastle&#39;s AuthorityKeyIdentifier to allow keyID to be set.">AuthorityKeyIdentifier</a> information.  <a href="#a0316e8dbddc7c37d9cf0652c5c9839c4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">X509Certificate&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a10cd274dc2bb36e627445076b8673354">sign</a> (String digestAlgorithm, PrivateKey signingKey)  throws CertificateEncodingException, InvalidKeyException, IllegalStateException, NoSuchAlgorithmException, SignatureException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate an X509 certificate, based on the current issuer and subject using the default provider.  <a href="#a10cd274dc2bb36e627445076b8673354"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93583ec4236348e3df9d865f8b9ef2cc"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::addExtension" ref="a93583ec4236348e3df9d865f8b9ef2cc" args="(String oid, boolean critical, byte[] value)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a93583ec4236348e3df9d865f8b9ef2cc">addExtension</a> (String oid, boolean critical, byte[] value)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Open up the ability to add additional extensions that aren't EKU or SubjectAltName (which we manage). <br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static X509Certificate&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad259fa48cf248bd7681c6d03248440c4">GenerateUserCertificate</a> (PublicKey userPublicKey, String subjectDN, long duration, PrivateKey signingKey)  throws CertificateEncodingException, InvalidKeyException, IllegalStateException, NoSuchAlgorithmException, SignatureException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a X509 certificate for a specified user , subject distinguished name and duration.  <a href="#ad259fa48cf248bd7681c6d03248440c4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static X509Certificate&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a3e0b0683801520ae25584d08d261e038">GenerateUserCertificate</a> (String subjectDN, PublicKey userPublicKey, X509Certificate issuerCertificate, long duration, PrivateKey signingKey)  throws CertificateEncodingException, InvalidKeyException, IllegalStateException, NoSuchAlgorithmException,  	         						SignatureException, IOException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a X509 certificate for a specified user , subject distinguished name and duration.  <a href="#a3e0b0683801520ae25584d08d261e038"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aabf65870cc3154c54cc9dfd538253c4f"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::GenerateUserCertificate" ref="aabf65870cc3154c54cc9dfd538253c4f" args="(KeyPair userKeyPair, String subjectDN, long duration)" -->
static X509Certificate&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#aabf65870cc3154c54cc9dfd538253c4f">GenerateUserCertificate</a> (KeyPair userKeyPair, String subjectDN, long duration)  throws CertificateEncodingException, InvalidKeyException, IllegalStateException, NoSuchAlgorithmException, SignatureException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static X509Certificate&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ab0e67abb252e77740a45ace1121c7289">GenerateUserCertificate</a> (PublicKey userPublicKey, String subjectDN, String emailAddress, long duration, PrivateKey signingKey)  throws CertificateEncodingException, InvalidKeyException, IllegalStateException, NoSuchAlgorithmException, SignatureException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates an X509 certificate for a specified user key, subject distinguished name, email address and duration.  <a href="#ab0e67abb252e77740a45ace1121c7289"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4fbabb94ad1fffcbd11090ad0dbecd0d"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::GenerateUserCertificate" ref="a4fbabb94ad1fffcbd11090ad0dbecd0d" args="(KeyPair userKeyPair, String subjectDN, String emailAddress, long duration)" -->
static X509Certificate&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a4fbabb94ad1fffcbd11090ad0dbecd0d">GenerateUserCertificate</a> (KeyPair userKeyPair, String subjectDN, String emailAddress, long duration)  throws CertificateEncodingException, InvalidKeyException, IllegalStateException, NoSuchAlgorithmException, SignatureException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper method. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad8e721b31a4b308aa8e0c95fffa018f3">writeCertificateChain</a> (File targetFile, X509Certificate userCertificate, List&lt; X509Certificate &gt; chain, int chainOffset, int chainCount)  throws CertificateEncodingException, FileNotFoundException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes file of certificates in the form expected by SSL_CTX_load_verify_locations() and (if in the right order) SSL_CTX_use_certificate_chain_file Quoting from the OpenSSL documentation: If CAfile is not NULL, it points to a file of CA certificates in PEM format.  <a href="#ad8e721b31a4b308aa8e0c95fffa018f3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5c2252e667af70e11c8889d869196f71"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::writePEMCertificate" ref="a5c2252e667af70e11c8889d869196f71" args="(PrintWriter writer, X509Certificate certificate)" -->
static void&#160;</td><td class="memItemRight" valign="bottom"><b>writePEMCertificate</b> (PrintWriter writer, X509Certificate certificate)  throws CertificateEncodingException </td></tr>
<tr><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a726d44f7ff60c5fc32c43dd76850a3ae"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::id_kp_serverAuth" ref="a726d44f7ff60c5fc32c43dd76850a3ae" args="" -->
static final DERObjectIdentifier&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a726d44f7ff60c5fc32c43dd76850a3ae">id_kp_serverAuth</a> = new DERObjectIdentifier(&quot;1.3.6.1.5.5.7.3.1&quot;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">A few useful OIDs that aren't in X509Extension, plus those that are (because they're protected there). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a950bc30756129691a74e4aa4b2b2139e"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::id_kp_clientAuth" ref="a950bc30756129691a74e4aa4b2b2139e" args="" -->
static final DERObjectIdentifier&#160;</td><td class="memItemRight" valign="bottom"><b>id_kp_clientAuth</b> = new DERObjectIdentifier(&quot;1.3.6.1.5.5.7.3.2&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abc28e7babb697b61f97d9a5485004bfc"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::id_kp_emailProtection" ref="abc28e7babb697b61f97d9a5485004bfc" args="" -->
static final DERObjectIdentifier&#160;</td><td class="memItemRight" valign="bottom"><b>id_kp_emailProtection</b> = new DERObjectIdentifier(&quot;1.3.6.1.5.5.7.3.4&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a28dfef7d9d38c133d54fd3d381fbc1d7"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::id_kp_ipsec" ref="a28dfef7d9d38c133d54fd3d381fbc1d7" args="" -->
static final DERObjectIdentifier&#160;</td><td class="memItemRight" valign="bottom"><b>id_kp_ipsec</b> = new DERObjectIdentifier(&quot;1.3.6.1.5.5.8.2.2&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae3445ae1fec5932272df0e76ca167d4e"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::SUN_PROVIDER" ref="ae3445ae1fec5932272df0e76ca167d4e" args="" -->
static final String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ae3445ae1fec5932272df0e76ca167d4e">SUN_PROVIDER</a> = &quot;SUN&quot;</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">We can't just use null to get the default provider and have any assurance of what it is, as a user can change the default provider. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adac0e504eabe2a3c10bd8e0b2f2c91ca"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::MSEC_IN_YEAR" ref="adac0e504eabe2a3c10bd8e0b2f2c91ca" args="" -->
static long&#160;</td><td class="memItemRight" valign="bottom"><b>MSEC_IN_YEAR</b> = 1000 * 60 * 60 * 24 * 365</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a778d4cf5d1f8b3dcf833e9469bf5fce2"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::BEGIN_CERTIFICATE" ref="a778d4cf5d1f8b3dcf833e9469bf5fce2" args="" -->
static final String&#160;</td><td class="memItemRight" valign="bottom"><b>BEGIN_CERTIFICATE</b> = &quot;-----BEGIN CERTIFICATE-----&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac32c31e807c5aa950e871c364033cfbd"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::END_CERTIFICATE" ref="ac32c31e807c5aa950e871c364033cfbd" args="" -->
static final String&#160;</td><td class="memItemRight" valign="bottom"><b>END_CERTIFICATE</b> = &quot;-----END CERTIFICATE-----&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad6b55777d7960b9184d4e37eb7adad01"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::CERTIFICATE_WRAP_LENGTH" ref="ad6b55777d7960b9184d4e37eb7adad01" args="" -->
static final int&#160;</td><td class="memItemRight" valign="bottom"><b>CERTIFICATE_WRAP_LENGTH</b> = 40</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad63b73973855056000464be82e20f42c"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::addExtendedKeyUsageExtension" ref="ad63b73973855056000464be82e20f42c" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad63b73973855056000464be82e20f42c">addExtendedKeyUsageExtension</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds an extended key usage extension to the certificate. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a32ce312892c7935ca2c2e93a560979b2"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::addAuthorityKeyIdentifierExtension" ref="a32ce312892c7935ca2c2e93a560979b2" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a32ce312892c7935ca2c2e93a560979b2">addAuthorityKeyIdentifierExtension</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds an authority key identifier extension to the certificate. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a352281017a85f2b80d73b8adda1faaf1"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::addSubjectAltNamesExtension" ref="a352281017a85f2b80d73b8adda1faaf1" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a352281017a85f2b80d73b8adda1faaf1">addSubjectAltNamesExtension</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds an subject alternative name extension to the certificate. <br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6bf48174636ffc76fe0d6831a5216569"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::_generator" ref="a6bf48174636ffc76fe0d6831a5216569" args="" -->
X509V3CertificateGenerator&#160;</td><td class="memItemRight" valign="bottom"><b>_generator</b> = new X509V3CertificateGenerator()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaa629d88068f935c1d3ddf102f44faf9"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::_ekus" ref="aaa629d88068f935c1d3ddf102f44faf9" args="" -->
Vector&lt; DERObjectIdentifier &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#aaa629d88068f935c1d3ddf102f44faf9">_ekus</a> = new Vector&lt;DERObjectIdentifier&gt;()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Cons up a list of EKUs and SubjectAltNames, then add them en masse just before signing. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16088531d56fa4bd1e8dd4264f28e7ab"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::_subjectAltNames" ref="a16088531d56fa4bd1e8dd4264f28e7ab" args="" -->
ASN1EncodableVector&#160;</td><td class="memItemRight" valign="bottom"><b>_subjectAltNames</b> = new ASN1EncodableVector()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0e27cb7ded8eece4a0483e36a88b29fc"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::_aki" ref="a0e27cb7ded8eece4a0483e36a88b29fc" args="" -->
<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_authority_key_identifier.html">AuthorityKeyIdentifier</a>&#160;</td><td class="memItemRight" valign="bottom"><b>_aki</b> = null</td></tr>
<tr><td colspan="2"><h2><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a257760b342fdff2820e6fc4625ddd938"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::DEFAULT_DIGEST_ALGORITHM" ref="a257760b342fdff2820e6fc4625ddd938" args="" -->
static final String&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a257760b342fdff2820e6fc4625ddd938">DEFAULT_DIGEST_ALGORITHM</a> = &quot;SHA&quot;</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">SHA is the official JCA name for SHA1. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae46134d1462d02cfe8db9f25b092f595"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::cachedRandom" ref="ae46134d1462d02cfe8db9f25b092f595" args="" -->
static Random&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ae46134d1462d02cfe8db9f25b092f595">cachedRandom</a> = new Random()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Cache a random number generator (non-secure, used for generating certificate serial numbers.) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8563f324a4b88baccfcddb1d5a7f4e0d"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::DATE_FORMAT" ref="a8563f324a4b88baccfcddb1d5a7f4e0d" args="" -->
static SimpleDateFormat&#160;</td><td class="memItemRight" valign="bottom"><b>DATE_FORMAT</b> = new SimpleDateFormat(&quot;yyMMddHHmmss&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab72705aaf381225a9db9c1490ba55cf5"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::TZ" ref="ab72705aaf381225a9db9c1490ba55cf5" args="" -->
static SimpleTimeZone&#160;</td><td class="memItemRight" valign="bottom"><b>TZ</b> = new SimpleTimeZone(0, &quot;Z&quot;)</td></tr>
<tr><td colspan="2"><h2><a name="pac-static-methods"></a>
Static Package Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c2061a9be0dbf0cb2848d25da0d224f"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::[static initializer]" ref="a1c2061a9be0dbf0cb2848d25da0d224f" args="" -->
&#160;</td><td class="memItemRight" valign="bottom"><b>[static initializer]</b></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Wrap BouncyCastle's X.509 certificate generator in a slightly more user-friendly way. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aaa6527537d183b50258549d54b566da8"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::MinimalCertificateGenerator" ref="aaa6527537d183b50258549d54b566da8" args="(String subjectDN, PublicKey subjectPublicKey, X509Certificate issuerCertificate, long duration, boolean isCA, Integer chainLength, boolean allUsage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#aaa6527537d183b50258549d54b566da8">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.MinimalCertificateGenerator</a> </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>subjectDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PublicKey&#160;</td>
          <td class="paramname"><em>subjectPublicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509Certificate&#160;</td>
          <td class="paramname"><em>issuerCertificate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>isCA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Integer&#160;</td>
          <td class="paramname"><em>chainLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>allUsage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throws CertificateEncodingException, IOException </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Certificate issued under an existing CA. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">subjectDN</td><td>the distinguished name of the subject. </td></tr>
    <tr><td class="paramname">subjectPublicKey</td><td>the public key of the subject. </td></tr>
    <tr><td class="paramname">issuerCertificate</td><td>the certificate of the issuer. </td></tr>
    <tr><td class="paramname">duration</td><td>the validity duration of the certificate. </td></tr>
    <tr><td class="paramname">isCA</td><td></td></tr>
    <tr><td class="paramname">allUsage</td><td>if isCA is true, add "regular" KeyUsage flags, for dual-use cert </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">CertificateEncodingException</td><td></td></tr>
    <tr><td class="paramname">IOException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9d5ee469a0c04fd1ee53b046fc7a3e1a"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::MinimalCertificateGenerator" ref="a9d5ee469a0c04fd1ee53b046fc7a3e1a" args="(String subjectDN, PublicKey subjectPublicKey, long duration, boolean isCA, boolean allUsage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#aaa6527537d183b50258549d54b566da8">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.MinimalCertificateGenerator</a> </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>subjectDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PublicKey&#160;</td>
          <td class="paramname"><em>subjectPublicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>isCA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>allUsage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Self-signed certificate (which may or may not be a CA). </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">subjectDN</td><td>the distinguished name of the subject. </td></tr>
    <tr><td class="paramname">subjectPublicKey</td><td>the public key of the subject. </td></tr>
    <tr><td class="paramname">duration</td><td>the validity duration of the certificate. </td></tr>
    <tr><td class="paramname">isCA</td><td>add basic constraints </td></tr>
    <tr><td class="paramname">allUsage</td><td>if isCA is true, add "regular" KeyUsage flags, for dual-use cert </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5e45691c1547c2af204ca73655417c87"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::MinimalCertificateGenerator" ref="a5e45691c1547c2af204ca73655417c87" args="(String subjectDN, PublicKey subjectPublicKey, X500Principal issuerDN, long duration, boolean isCA, Integer chainLength, boolean allUsage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#aaa6527537d183b50258549d54b566da8">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.MinimalCertificateGenerator</a> </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>subjectDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PublicKey&#160;</td>
          <td class="paramname"><em>subjectPublicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X500Principal&#160;</td>
          <td class="paramname"><em>issuerDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>isCA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Integer&#160;</td>
          <td class="paramname"><em>chainLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>allUsage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Basic common path. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">subjectDN</td><td>the distinguished name of the subject. </td></tr>
    <tr><td class="paramname">subjectPublicKey</td><td>the public key of the subject. </td></tr>
    <tr><td class="paramname">issuerDN</td><td>the distinguished name of the issuer. </td></tr>
    <tr><td class="paramname">duration</td><td>the validity duration of the certificate. </td></tr>
    <tr><td class="paramname">isCA</td><td></td></tr>
    <tr><td class="paramname">allUsage</td><td>if isCA is true, add "regular" KeyUsage flags, for dual-use cert </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a0316e8dbddc7c37d9cf0652c5c9839c4"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::addAuthorityName" ref="a0316e8dbddc7c37d9cf0652c5c9839c4" args="(URI authorityName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a0316e8dbddc7c37d9cf0652c5c9839c4">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.addAuthorityName</a> </td>
          <td>(</td>
          <td class="paramtype">URI&#160;</td>
          <td class="paramname"><em>authorityName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add additional <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_authority_key_identifier.html" title="Reimplementation of BouncyCastle&#39;s AuthorityKeyIdentifier to allow keyID to be set.">AuthorityKeyIdentifier</a> information. </p>
<p>We've already set key ID. </p>

</div>
</div>
<a class="anchor" id="ad259fa48cf248bd7681c6d03248440c4"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::GenerateUserCertificate" ref="ad259fa48cf248bd7681c6d03248440c4" args="(PublicKey userPublicKey, String subjectDN, long duration, PrivateKey signingKey)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static X509Certificate <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad259fa48cf248bd7681c6d03248440c4">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.GenerateUserCertificate</a> </td>
          <td>(</td>
          <td class="paramtype">PublicKey&#160;</td>
          <td class="paramname"><em>userPublicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>subjectDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrivateKey&#160;</td>
          <td class="paramname"><em>signingKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throws CertificateEncodingException, InvalidKeyException, IllegalStateException, NoSuchAlgorithmException, SignatureException <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generates a X509 certificate for a specified user , subject distinguished name and duration. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">userKeyPair</td><td>the user key pair. </td></tr>
    <tr><td class="paramname">subjectDN</td><td>the distinguished name of the user. </td></tr>
    <tr><td class="paramname">duration</td><td>the duration of validity of the certificate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the X509 certificate. </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">CertificateEncodingException</td><td></td></tr>
    <tr><td class="paramname">InvalidKeyException</td><td></td></tr>
    <tr><td class="paramname">IllegalStateException</td><td></td></tr>
    <tr><td class="paramname">NoSuchAlgorithmException</td><td></td></tr>
    <tr><td class="paramname">SignatureException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3e0b0683801520ae25584d08d261e038"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::GenerateUserCertificate" ref="a3e0b0683801520ae25584d08d261e038" args="(String subjectDN, PublicKey userPublicKey, X509Certificate issuerCertificate, long duration, PrivateKey signingKey)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static X509Certificate <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad259fa48cf248bd7681c6d03248440c4">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.GenerateUserCertificate</a> </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>subjectDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PublicKey&#160;</td>
          <td class="paramname"><em>userPublicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509Certificate&#160;</td>
          <td class="paramname"><em>issuerCertificate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrivateKey&#160;</td>
          <td class="paramname"><em>signingKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throws CertificateEncodingException, InvalidKeyException, IllegalStateException, NoSuchAlgorithmException,  	         						SignatureException, IOException <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generates a X509 certificate for a specified user , subject distinguished name and duration. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">userKeyPair</td><td>the user key pair. </td></tr>
    <tr><td class="paramname">subjectDN</td><td>the distinguished name of the user. </td></tr>
    <tr><td class="paramname">duration</td><td>the duration of validity of the certificate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the X509 certificate. </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">CertificateEncodingException</td><td></td></tr>
    <tr><td class="paramname">InvalidKeyException</td><td></td></tr>
    <tr><td class="paramname">IllegalStateException</td><td></td></tr>
    <tr><td class="paramname">NoSuchAlgorithmException</td><td></td></tr>
    <tr><td class="paramname">SignatureException</td><td></td></tr>
    <tr><td class="paramname">IOException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab0e67abb252e77740a45ace1121c7289"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::GenerateUserCertificate" ref="ab0e67abb252e77740a45ace1121c7289" args="(PublicKey userPublicKey, String subjectDN, String emailAddress, long duration, PrivateKey signingKey)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static X509Certificate <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad259fa48cf248bd7681c6d03248440c4">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.GenerateUserCertificate</a> </td>
          <td>(</td>
          <td class="paramtype">PublicKey&#160;</td>
          <td class="paramname"><em>userPublicKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>subjectDN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>emailAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrivateKey&#160;</td>
          <td class="paramname"><em>signingKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throws CertificateEncodingException, InvalidKeyException, IllegalStateException, NoSuchAlgorithmException, SignatureException <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generates an X509 certificate for a specified user key, subject distinguished name, email address and duration. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">userKeyPair</td><td>the user key pair. </td></tr>
    <tr><td class="paramname">subjectDN</td><td>the distinguished name of the subject. </td></tr>
    <tr><td class="paramname">emailAddress</td><td>the email address. </td></tr>
    <tr><td class="paramname">duration</td><td>the validity duration of the certificate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the X509 certificate. </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">CertificateEncodingException</td><td></td></tr>
    <tr><td class="paramname">InvalidKeyException</td><td></td></tr>
    <tr><td class="paramname">IllegalStateException</td><td></td></tr>
    <tr><td class="paramname">NoSuchAlgorithmException</td><td></td></tr>
    <tr><td class="paramname">SignatureException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa10dd7a876e769ac0bd5fca7fc12fdba"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::setIPSecUsage" ref="aa10dd7a876e769ac0bd5fca7fc12fdba" args="(String ipAddress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#aa10dd7a876e769ac0bd5fca7fc12fdba">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.setIPSecUsage</a> </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>ipAddress</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds ip address to subjectAltName and IPSec usage to EKU. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">ipAddress</td><td>string form of the IP address. Assumed to be in either IPv4 form, "n.n.n.n", with 0&lt;=n&lt;256, orIPv6 form, "n.n.n.n.n.n.n.n", where the n's are the HEXADECIMAL form of the 16-bit address components. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad090c4fe400a5012499fb137040f25af"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::setSecureEmailUsage" ref="ad090c4fe400a5012499fb137040f25af" args="(String subjectEmailAddress)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad090c4fe400a5012499fb137040f25af">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.setSecureEmailUsage</a> </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>subjectEmailAddress</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Both adds the secure email OID to the EKU extension, and adds the email address to the subject alt name extension (not marked critical). </p>
<p>(Combines addSecureEmailEKU and addEmailSubjectAltName). </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">subjectEmailAddress</td><td>the email address of the subject. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad9b1469aafb2d4823c497721ac422819"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::setServerAuthenticationUsage" ref="ad9b1469aafb2d4823c497721ac422819" args="(String serverDNSName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad9b1469aafb2d4823c497721ac422819">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.setServerAuthenticationUsage</a> </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>serverDNSName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Both adds the server authentication OID to the EKU extension, and adds the DNS name to the subject alt name extension (not marked critical). </p>
<p>(Combines addServerAuthenticationEKU and addDNSNameSubjectAltName). </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">serverDNSName</td><td>the DNS name of the server. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a10cd274dc2bb36e627445076b8673354"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::sign" ref="a10cd274dc2bb36e627445076b8673354" args="(String digestAlgorithm, PrivateKey signingKey)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">X509Certificate <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#a10cd274dc2bb36e627445076b8673354">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.sign</a> </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>digestAlgorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PrivateKey&#160;</td>
          <td class="paramname"><em>signingKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throws CertificateEncodingException, InvalidKeyException, IllegalStateException, NoSuchAlgorithmException, SignatureException </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate an X509 certificate, based on the current issuer and subject using the default provider. </p>
<p>Use the old form of the BC certificate generation call for compatibility with older versions of BouncyCastle; suppress the deprecation warning on newer platforms. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">digestAlgorithm</td><td>the digest algorithm. </td></tr>
    <tr><td class="paramname">signingKey</td><td>the signing key. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the X509 certificate. </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">CertificateEncodingException</td><td></td></tr>
    <tr><td class="paramname">InvalidKeyException</td><td></td></tr>
    <tr><td class="paramname">IllegalStateException</td><td></td></tr>
    <tr><td class="paramname">NoSuchAlgorithmException</td><td></td></tr>
    <tr><td class="paramname">SignatureException</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>Finalize extensions.</p>

</div>
</div>
<a class="anchor" id="ad8e721b31a4b308aa8e0c95fffa018f3"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::util::MinimalCertificateGenerator::writeCertificateChain" ref="ad8e721b31a4b308aa8e0c95fffa018f3" args="(File targetFile, X509Certificate userCertificate, List&lt; X509Certificate &gt; chain, int chainOffset, int chainCount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html#ad8e721b31a4b308aa8e0c95fffa018f3">org.ccnx.ccn.impl.security.crypto.util.MinimalCertificateGenerator.writeCertificateChain</a> </td>
          <td>(</td>
          <td class="paramtype">File&#160;</td>
          <td class="paramname"><em>targetFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509Certificate&#160;</td>
          <td class="paramname"><em>userCertificate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">List&lt; X509Certificate &gt;&#160;</td>
          <td class="paramname"><em>chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chainOffset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>chainCount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throws CertificateEncodingException, FileNotFoundException <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Writes file of certificates in the form expected by SSL_CTX_load_verify_locations() and (if in the right order) SSL_CTX_use_certificate_chain_file Quoting from the OpenSSL documentation: If CAfile is not NULL, it points to a file of CA certificates in PEM format. </p>
<p>The file can contain several CA certificates identified by -----BEGIN CERTIFICATE----- ... (CA certificate in base64 encoding) ... -----END CERTIFICATE----- sequences. Before, between, and after the certificates text is allowed which can be used e.g. for descriptions of the certificates.</p>
<p>From documentation: SSL_CTX_use_certificate_chain_file loads a certificate chain from file into ctx. The certificates must be in PEM format and must be sorted starting with the subject's certificate (actual client or server certificate), followed by intermediate CA certificates if applicable, and ending at the highest level (root) CA. There is no corresponding function working on a single SSL object. This method assumes the caller already has ordered the chain. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">userDirectory</td><td></td></tr>
    <tr><td class="paramname">userCertificate</td><td>if not null, the first cert to write in the chain </td></tr>
    <tr><td class="paramname">chain</td><td>a set of certificates to write after any user certificate. Written in order given, can be used to write an ordered chain or a set of roots where order doesn't matter. </td></tr>
    <tr><td class="paramname">chainOffset</td><td>the index into chain to start writing </td></tr>
    <tr><td class="paramname">chainCount</td><td>the number of certs to output. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">CertificateEncodingException</td><td></td></tr>
    <tr><td class="paramname">FileNotFoundException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/main/org/ccnx/ccn/impl/security/crypto/util/MinimalCertificateGenerator.java</li>
</ul>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>org</b>      </li>
      <li class="navelem"><b>ccnx</b>      </li>
      <li class="navelem"><b>ccn</b>      </li>
      <li class="navelem"><a class="el" href="namespaceorg_1_1ccnx_1_1ccn_1_1impl.html">impl</a>      </li>
      <li class="navelem"><b>security</b>      </li>
      <li class="navelem"><b>crypto</b>      </li>
      <li class="navelem"><b>util</b>      </li>
      <li class="navelem"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1util_1_1_minimal_certificate_generator.html">MinimalCertificateGenerator</a>      </li>

    <li class="footer">Generated on Tue Apr 1 2014 10:51:28 for Content-Centric Networking in Java by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
