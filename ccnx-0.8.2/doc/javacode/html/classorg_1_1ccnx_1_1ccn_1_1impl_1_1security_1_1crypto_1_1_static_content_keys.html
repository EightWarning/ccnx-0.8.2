<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Content-Centric Networking in Java: org.ccnx.ccn.impl.security.crypto.StaticContentKeys Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Content-Centric Networking in Java
   &#160;<span id="projectnumber">0.8.2</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">org.ccnx.ccn.impl.security.crypto.StaticContentKeys Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="org::ccnx::ccn::impl::security::crypto::StaticContentKeys" --><!-- doxytag: inherits="org::ccnx::ccn::impl::security::crypto::ContentKeys,Cloneable" -->
<p>This is a very simple approach to encryption keying that uses a fixed, static encryption key and an IV "seed" that is used to prefix segment-specific IVs or counters.  
 <a href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#details">More...</a></p>

<p><a href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#a3bb81a274104bb97f48f211f4946d43e">StaticContentKeys</a> (String encryptionAlgorithm, byte[] key, byte[] ivCtr)  throws NoSuchAlgorithmException, NoSuchPaddingException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html" title="This is a very simple approach to encryption keying that uses a fixed, static encryption key and an I...">StaticContentKeys</a> constructor.  <a href="#a3bb81a274104bb97f48f211f4946d43e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#ad34202e4778e13d830b2dbf1d3974ef7">StaticContentKeys</a> (byte[] key, byte[] ivCtr)  throws NoSuchAlgorithmException, NoSuchPaddingException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html" title="This is a very simple approach to encryption keying that uses a fixed, static encryption key and an I...">StaticContentKeys</a> with the default algorithm.  <a href="#ad34202e4778e13d830b2dbf1d3974ef7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a34207e7e30a2e14040a5024c4bb0be2a"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::StaticContentKeys" ref="a34207e7e30a2e14040a5024c4bb0be2a" args="(String encryptionAlgorithm, Key key, byte[] ivCtr)" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#a34207e7e30a2e14040a5024c4bb0be2a">StaticContentKeys</a> (String encryptionAlgorithm, Key key, byte[] ivCtr)  throws NoSuchAlgorithmException, NoSuchPaddingException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html" title="This is a very simple approach to encryption keying that uses a fixed, static encryption key and an I...">StaticContentKeys</a> constructor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a79f4b6a5699a5c76f3e7f9805cc0d846"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::StaticContentKeys" ref="a79f4b6a5699a5c76f3e7f9805cc0d846" args="(ContentKeys other)" -->
&#160;</td><td class="memItemRight" valign="bottom"><b>StaticContentKeys</b> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys.html">ContentKeys</a> other)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a946e7ee04706a0b846bfe45c843c2d44"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::clone" ref="a946e7ee04706a0b846bfe45c843c2d44" args="()" -->
<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html">StaticContentKeys</a>&#160;</td><td class="memItemRight" valign="bottom"><b>clone</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">IvParameterSpec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#af235bfcae5a046b862e65106c0015cd8">buildIVCtr</a> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_key_and_i_v.html">KeyAndIV</a> keyAndIV, long segmentNumber, int ctrLen)  throws InvalidKeyException, InvalidAlgorithmParameterException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn a master IV and a segment number into an initial counter of IV for this segment (used in CTR mode).  <a href="#af235bfcae5a046b862e65106c0015cd8"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static synchronized <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys.html">ContentKeys</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#a65eaaff791b23889c11c5de41d3d2f85">generateRandomKeys</a> ()  throws NoSuchAlgorithmException, NoSuchPaddingException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a set of random encryption/decryption keys using the default algorithm.  <a href="#a65eaaff791b23889c11c5de41d3d2f85"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5cbb2437fe1d9d09ed91ef19e490a058"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::segmentSeedValue" ref="a5cbb2437fe1d9d09ed91ef19e490a058" args="(byte[] ivCtr, long segmentNumber, int seedLen)" -->
static byte[]&#160;</td><td class="memItemRight" valign="bottom"><b>segmentSeedValue</b> (byte[] ivCtr, long segmentNumber, int seedLen)</td></tr>
<tr><td colspan="2"><h2><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a04d3d14bdb6120c06b09afaf808685c4"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::IV_MASTER_LENGTH" ref="a04d3d14bdb6120c06b09afaf808685c4" args="" -->
static final int&#160;</td><td class="memItemRight" valign="bottom"><b>IV_MASTER_LENGTH</b> = 8</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac8b1e89ed51c823ce5e255bc52b66799"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::SEGMENT_NUMBER_LENGTH" ref="ac8b1e89ed51c823ce5e255bc52b66799" args="" -->
static final int&#160;</td><td class="memItemRight" valign="bottom"><b>SEGMENT_NUMBER_LENGTH</b> = 6</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa9c82ebce9e6a5b3fdd1cdc95ae3c9d3"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::BLOCK_COUNTER_LENGTH" ref="aa9c82ebce9e6a5b3fdd1cdc95ae3c9d3" args="" -->
static final int&#160;</td><td class="memItemRight" valign="bottom"><b>BLOCK_COUNTER_LENGTH</b> = INITIAL_BLOCK_COUNTER_VALUE.length</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Cipher&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#a0781bfdf168df36e264ba618d44b77da">getSegmentCipher</a> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a> contentName, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_publisher_public_key_digest.html">PublisherPublicKeyDigest</a> publisher, long segmentNumber, boolean encryption)  throws InvalidKeyException, InvalidAlgorithmParameterException, ContentEncodingException </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate a segment encryption or decryption cipher using this stored key material to encrypt or decrypt a particular segment.  <a href="#a0781bfdf168df36e264ba618d44b77da"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5037de67ee6aa4fc41251cb32682be9d"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::getKeyAndIVForContent" ref="a5037de67ee6aa4fc41251cb32682be9d" args="(ContentName contentName, PublisherPublicKeyDigest publisher, long segmentNumber)" -->
<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_key_and_i_v.html">KeyAndIV</a>&#160;</td><td class="memItemRight" valign="bottom"><b>getKeyAndIVForContent</b> (<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a> contentName, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_publisher_public_key_digest.html">PublisherPublicKeyDigest</a> publisher, long segmentNumber)  throws InvalidKeyException, ContentEncodingException </td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This is a very simple approach to encryption keying that uses a fixed, static encryption key and an IV "seed" that is used to prefix segment-specific IVs or counters. </p>
<p>The segmenter will be called with parameters identifying:</p>
<p>* the encryption algorithm and mode to use, if any * the encryption key to use for this particular data item (the object to be segmented) * an 8-byte value used as an IV seed for this item (CBC or other block mode) or a random counter component (CTR) (derived in KeyDerivation) * the desired full segment (packet) length, including supporting data</p>
<p>The initial counter or IV for a given block B (number Bnum) in segment Snum will be constructed as follows:</p>
<p>Block IV/CTR = IVseed || Snum || Bnum</p>
<p>where the segment and block numbers is represented in unsigned, 1-based big endian format.</p>
<p>The total width of the IV/Counter value is B, the block width of the cipher. For a stream cipher (e.g. CTR mode), the width B is taken to be 16 bytes.</p>
<p>This IV/CTR is divided into 3 components:</p>
<p>Master IV/IVseed : the master IV seed value, specified by the caller. For this simple static key approach, this is by default 8 bytes. It is given by masterIVLength().</p>
<p>Segment number: this is a binary representation of the segment number. A single-segment object following the SegmentationProfile will still have a segment number component in its name, and will use the specified segment number (usually <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1profiles_1_1_segmentation_profile.html#acd28bc3d6df1a690f90626a5fe656e85" title="Control whether fragments start at 0 or 1.">SegmentationProfile.baseSegment()</a>).</p>
<p>The segment number is encoded in 1-based, unsigned, big-endian form, and represented in the L-N rightmost bytes of the plaintext above, where L is the length of the numeric representation of the segment number, and N is the length of the block number within the segment (for CTR mode, this value is fixed at 1 for CBC and other block modes).</p>
<p>The default width of the segment number is 6 bytes, leaving 8 bytes for the default Master IV width.</p>
<p>Block number: for CTR mode, the last 2 bytes of the IV contain the block (counter) index, starting with 1. For CBC and other block modes, that last two bytes contains the (big endian) value 0x0001.</p>
<p>The same IV expansion function is used regardless of mode for simplicity.</p>
<p>Many of the expansion function calculations are broken out into separate methods to allow for easier subclassing.</p>
<p>IMPORTANT NOTE: Do not use static keying to encrypt network objects in CTR mode, unless you are careful to only save them once per key. Use CBC mode (under development) or a dynamic keying method, such as <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_k_d_f_content_keys.html" title="A subclass of EncryptedIVStaticContentKeys that uses the methods from that class to derive a per-segm...">KDFContentKeys</a>. </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a3bb81a274104bb97f48f211f4946d43e"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::StaticContentKeys" ref="a3bb81a274104bb97f48f211f4946d43e" args="(String encryptionAlgorithm, byte[] key, byte[] ivCtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#a3bb81a274104bb97f48f211f4946d43e">org.ccnx.ccn.impl.security.crypto.StaticContentKeys.StaticContentKeys</a> </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>encryptionAlgorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte[]&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte[]&#160;</td>
          <td class="paramname"><em>ivCtr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throws NoSuchAlgorithmException, NoSuchPaddingException </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html" title="This is a very simple approach to encryption keying that uses a fixed, static encryption key and an I...">StaticContentKeys</a> constructor. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">encryptionAlgorithm</td><td>(e.g. AES/CTR/NoPadding) the encryption algorithm to use. First component of algorithm should be the algorithm associated with the key. </td></tr>
    <tr><td class="paramname">key</td><td>key material to be used </td></tr>
    <tr><td class="paramname">ivctr</td><td>iv or counter material to be used with specified algorithm </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">NoSuchPaddingException</td><td></td></tr>
    <tr><td class="paramname">NoSuchAlgorithmException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad34202e4778e13d830b2dbf1d3974ef7"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::StaticContentKeys" ref="ad34202e4778e13d830b2dbf1d3974ef7" args="(byte[] key, byte[] ivCtr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#a3bb81a274104bb97f48f211f4946d43e">org.ccnx.ccn.impl.security.crypto.StaticContentKeys.StaticContentKeys</a> </td>
          <td>(</td>
          <td class="paramtype">byte[]&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">byte[]&#160;</td>
          <td class="paramname"><em>ivCtr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throws NoSuchAlgorithmException, NoSuchPaddingException </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html" title="This is a very simple approach to encryption keying that uses a fixed, static encryption key and an I...">StaticContentKeys</a> with the default algorithm. </p>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">NoSuchPaddingException</td><td></td></tr>
    <tr><td class="paramname">NoSuchAlgorithmException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="af235bfcae5a046b862e65106c0015cd8"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::buildIVCtr" ref="af235bfcae5a046b862e65106c0015cd8" args="(KeyAndIV keyAndIV, long segmentNumber, int ctrLen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IvParameterSpec <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#af235bfcae5a046b862e65106c0015cd8">org.ccnx.ccn.impl.security.crypto.StaticContentKeys.buildIVCtr</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys_1_1_key_and_i_v.html">KeyAndIV</a>&#160;</td>
          <td class="paramname"><em>keyAndIV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>segmentNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctrLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throws InvalidKeyException, InvalidAlgorithmParameterException </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Turn a master IV and a segment number into an initial counter of IV for this segment (used in CTR mode). </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">masterIV</td><td>the master IV </td></tr>
    <tr><td class="paramname">segmentNumber</td><td>the segment number </td></tr>
    <tr><td class="paramname">ctrLen</td><td>the output IV length requested </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the initial counter </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidAlgorithmParameterException</td><td></td></tr>
    <tr><td class="paramname">InvalidKeyException</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_encrypted_i_v_static_content_keys.html#a4398a1b1bff6e960d421f6bf718424ba">org.ccnx.ccn.impl.security.crypto.EncryptedIVStaticContentKeys</a>.</p>

</div>
</div>
<a class="anchor" id="a65eaaff791b23889c11c5de41d3d2f85"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::generateRandomKeys" ref="a65eaaff791b23889c11c5de41d3d2f85" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static synchronized <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys.html">ContentKeys</a> <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#a65eaaff791b23889c11c5de41d3d2f85">org.ccnx.ccn.impl.security.crypto.StaticContentKeys.generateRandomKeys</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>  throws NoSuchAlgorithmException, NoSuchPaddingException <code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a set of random encryption/decryption keys using the default algorithm. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>a randomly-generated set of keys and IV that can be used for encryption </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">NoSuchPaddingException</td><td></td></tr>
    <tr><td class="paramname">NoSuchAlgorithmException</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_encrypted_i_v_static_content_keys.html#a346c08b5a00d6ae591a5640870760e52">org.ccnx.ccn.impl.security.crypto.EncryptedIVStaticContentKeys</a>.</p>

</div>
</div>
<a class="anchor" id="a0781bfdf168df36e264ba618d44b77da"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::crypto::StaticContentKeys::getSegmentCipher" ref="a0781bfdf168df36e264ba618d44b77da" args="(ContentName contentName, PublisherPublicKeyDigest publisher, long segmentNumber, boolean encryption)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Cipher <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html#a0781bfdf168df36e264ba618d44b77da">org.ccnx.ccn.impl.security.crypto.StaticContentKeys.getSegmentCipher</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_content_name.html">ContentName</a>&#160;</td>
          <td class="paramname"><em>contentName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1protocol_1_1_publisher_public_key_digest.html">PublisherPublicKeyDigest</a>&#160;</td>
          <td class="paramname"><em>publisher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>segmentNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boolean&#160;</td>
          <td class="paramname"><em>encryption</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>  throws InvalidKeyException, InvalidAlgorithmParameterException, <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1io_1_1content_1_1_content_encoding_exception.html">ContentEncodingException</a> <code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate a segment encryption or decryption cipher using this stored key material to encrypt or decrypt a particular segment. </p>
<p>This will use the CCN defaults for IV handling, to ensure that segments of a given larger piece of content do not have overlapping key streams. Higher-level functionality embodied in the library (or application-specific code) should be used to make sure that the key, _masterIV pair used for a given multi-block piece of content is unique for that content.</p>
<p>CCN encryption algorithms assume deterministic IV generation (e.g. from cryptographic MAC or ciphers themselves), and therefore do not transport the IV explicitly. Applications that wish to do so need to arrange IV transport.</p>
<p>We assume this stream starts on the first block of a multi-block segement, so for CTR mode, the initial block counter is 1 (block == encryption block). (Conventions for counter start them at 1, not 0.) The cipher will automatically increment the counter; if it overflows the two bytes we've given to it it will start to increment into the segment number. This runs the risk of potentially using up some of the IV space of other segments.</p>
<p>CTR_init = IV_master || segment_number || block_counter CBC_iv = E_Ko(IV_master || segment_number || 0x0001) (just to make it easier, use the same feed value)</p>
<p>CTR value is 16 bytes. 8 bytes are the IV. 6 bytes are the segment number. last 2 bytes are the block number (for 16 byte blocks); if you have more space, use it for the block counter. IV value is the block width of the cipher.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">segmentNumber</td><td>segment to encrypt/decrypt </td></tr>
    <tr><td class="paramname">encryption</td><td>true for encryption, false for decryption </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the Cipher </dd></dl>
<dl class="exception"><dt><b>Exceptions:</b></dt><dd>
  <table class="exception">
    <tr><td class="paramname">InvalidKeyException</td><td></td></tr>
    <tr><td class="paramname">InvalidAlgorithmParameterException</td><td></td></tr>
    <tr><td class="paramname">ContentEncodingException</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="see"><dt><b>See also:</b></dt><dd>getSegmentEncryptionCipher(long) </dd></dl>

<p>Implements <a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_content_keys.html#aa0859498d408cd3f2a782db5c4aaf2db">org.ccnx.ccn.impl.security.crypto.ContentKeys</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/main/org/ccnx/ccn/impl/security/crypto/StaticContentKeys.java</li>
</ul>
</div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><b>org</b>      </li>
      <li class="navelem"><b>ccnx</b>      </li>
      <li class="navelem"><b>ccn</b>      </li>
      <li class="navelem"><a class="el" href="namespaceorg_1_1ccnx_1_1ccn_1_1impl.html">impl</a>      </li>
      <li class="navelem"><b>security</b>      </li>
      <li class="navelem"><b>crypto</b>      </li>
      <li class="navelem"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1crypto_1_1_static_content_keys.html">StaticContentKeys</a>      </li>

    <li class="footer">Generated on Tue Apr 1 2014 10:51:28 for Content-Centric Networking in Java by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
