<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Content-Centric Networking in C: ccnd/ccnd_strategy.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Content-Centric Networking in C
   &#160;<span id="projectnumber">0.8.2</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_e530da5cb8dad925e11fb53b7a06d15d.html">ccnd</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ccnd_strategy.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ccnd__strategy_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**</span>
<a name="l00002"></a>00002 <span class="comment"> * @file ccnd_strategy.h</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * This header defines the API to be used by strategy callouts.</span>
<a name="l00005"></a>00005 <span class="comment"> *</span>
<a name="l00006"></a>00006 <span class="comment"> * Part of ccnd - the CCNx Daemon.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * Copyright (C) 2013 Palo Alto Research Center, Inc.</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * This work is free software; you can redistribute it and/or modify it under</span>
<a name="l00011"></a>00011 <span class="comment"> * the terms of the GNU General Public License version 2 as published by the</span>
<a name="l00012"></a>00012 <span class="comment"> * Free Software Foundation.</span>
<a name="l00013"></a>00013 <span class="comment"> * This work is distributed in the hope that it will be useful, but WITHOUT ANY</span>
<a name="l00014"></a>00014 <span class="comment"> * WARRANTY; without even the implied warranty of MERCHANTABILITY or</span>
<a name="l00015"></a>00015 <span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment"> * for more details. You should have received a copy of the GNU General Public</span>
<a name="l00017"></a>00017 <span class="comment"> * License along with this program; if not, write to the</span>
<a name="l00018"></a>00018 <span class="comment"> * Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,</span>
<a name="l00019"></a>00019 <span class="comment"> * Boston, MA 02110-1301, USA.</span>
<a name="l00020"></a>00020 <span class="comment"> */</span>
<a name="l00021"></a>00021  
<a name="l00022"></a>00022 <span class="preprocessor">#ifndef CCND_STRATEGY_DEFINED</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="preprocessor">#define CCND_STRATEGY_DEFINED</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;stddef.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;stdint.h&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="comment">/* These types should remain opaque for strategy routines */</span>
<a name="l00030"></a>00030 <span class="keyword">struct </span><a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a>;
<a name="l00031"></a>00031 <span class="keyword">struct </span><a class="code" href="structinterest__entry.html" title="The interest hash table is keyed by the interest message.">interest_entry</a>;
<a name="l00032"></a>00032 <span class="keyword">struct </span><a class="code" href="structface.html" title="One of our active faces.">face</a>;
<a name="l00033"></a>00033 <span class="keyword">struct </span><a class="code" href="structnameprefix__entry.html" title="The nameprefix hash table is keyed by the Component elements of the Name prefix.">nameprefix_entry</a>;
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="comment">/* Forward struct defined later in this header */</span>
<a name="l00036"></a>00036 <span class="keyword">struct </span><a class="code" href="structstrategy__instance.html">strategy_instance</a>;
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 
<a name="l00039"></a><a class="code" href="ccnd__strategy_8h.html#abd34e0ff54c96fffa0e586448cc8611f">00039</a> <span class="preprocessor">#define CCN_UNINIT    (~0U)     </span><span class="comment">/**&lt; initial value of strategy vars */</span>
<a name="l00040"></a><a class="code" href="ccnd__strategy_8h.html#ab4cd52e46b26364ced188f8d40cc08c8">00040</a> <span class="preprocessor">#define CCN_MAGIC_MASK 0x00FFFFFF </span><span class="comment">/**&lt; for magic number */</span>
<a name="l00041"></a><a class="code" href="ccnd__strategy_8h.html#ad6a8e3f7aa77795a3420991427169182">00041</a> <span class="preprocessor">#define CCN_AGED       0x10000000 </span><span class="comment">/**&lt; for aging */</span>
<a name="l00042"></a><a class="code" href="ccnd__strategy_8h.html#ae31798026041d17e7982de1468552db4">00042</a> <span class="preprocessor">#define CCND_STRATEGY_STATE_N 4 </span><span class="comment">/**&lt; number of per-prefix strategy vars */</span>
<a name="l00043"></a>00043 <span class="comment"></span>
<a name="l00044"></a>00044 <span class="comment">/**</span>
<a name="l00045"></a>00045 <span class="comment"> * This is a place for strategies to record state that is attached</span>
<a name="l00046"></a>00046 <span class="comment"> * to a given name prefix.</span>
<a name="l00047"></a>00047 <span class="comment"> *</span>
<a name="l00048"></a>00048 <span class="comment"> * At this level, we simply have an array of unsigned ints.</span>
<a name="l00049"></a>00049 <span class="comment"> * The leading value, s[0], has some special significance in</span>
<a name="l00050"></a>00050 <span class="comment"> * that it should be used hold a value that identifies the</span>
<a name="l00051"></a>00051 <span class="comment"> * interpretation of the remaining values, as well as an aging flag.</span>
<a name="l00052"></a>00052 <span class="comment"> *</span>
<a name="l00053"></a>00053 <span class="comment"> * When a name prefix entry is created, the associated state</span>
<a name="l00054"></a>00054 <span class="comment"> * is initialized to all CCN_UNINIT.</span>
<a name="l00055"></a>00055 <span class="comment"> */</span>
<a name="l00056"></a><a class="code" href="structnameprefix__state.html">00056</a> <span class="keyword">struct </span><a class="code" href="structnameprefix__state.html" title="This is a place for strategies to record state that is attached to a given name prefix.">nameprefix_state</a> {
<a name="l00057"></a><a class="code" href="structnameprefix__state.html#a2e84d7c2b90a1754ff21f544b1078940">00057</a>     <span class="keywordtype">unsigned</span> <a class="code" href="structnameprefix__state.html#a2e84d7c2b90a1754ff21f544b1078940">s</a>[<a class="code" href="ccnd__strategy_8h.html#ae31798026041d17e7982de1468552db4" title="number of per-prefix strategy vars">CCND_STRATEGY_STATE_N</a>];
<a name="l00058"></a>00058 };
<a name="l00059"></a>00059 <span class="comment"></span>
<a name="l00060"></a>00060 <span class="comment">/**</span>
<a name="l00061"></a>00061 <span class="comment"> * Use this macro to make sure that overlaying structures are not oversize</span>
<a name="l00062"></a>00062 <span class="comment"> *</span>
<a name="l00063"></a>00063 <span class="comment"> * XX is an otherwise unused identifier, and T is the overlaid struct type.</span>
<a name="l00064"></a>00064 <span class="comment"> * This is intended to cause a compilation error if T becomes too large.</span>
<a name="l00065"></a>00065 <span class="comment"> */</span>
<a name="l00066"></a><a class="code" href="ccnd__strategy_8h.html#ae566edad1ffc8911b818920e1539fb57">00066</a> <span class="preprocessor">#define CCN_STATESIZECHECK(XX, T) \</span>
<a name="l00067"></a>00067 <span class="preprocessor">    struct XX {char x[(int)((sizeof(T) &gt; sizeof(struct nameprefix_state)) ? -1 : 1)];}</span>
<a name="l00068"></a>00068 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00069"></a>00069 <span class="comment">/**</span>
<a name="l00070"></a>00070 <span class="comment"> * Used for keeping track of interest expiry.</span>
<a name="l00071"></a>00071 <span class="comment"> *</span>
<a name="l00072"></a>00072 <span class="comment"> * Modulo 2**32 - time units and origin are arbitrary and private.</span>
<a name="l00073"></a>00073 <span class="comment"> */</span>
<a name="l00074"></a><a class="code" href="ccnd__strategy_8h.html#a5a898d6229f4c0146bd54fd8240e05bf">00074</a> <span class="keyword">typedef</span> uint32_t <a class="code" href="ccnd__strategy_8h.html#a5a898d6229f4c0146bd54fd8240e05bf" title="Used for keeping track of interest expiry.">ccn_wrappedtime</a>;
<a name="l00075"></a>00075 <span class="comment"></span>
<a name="l00076"></a>00076 <span class="comment">/** A faceid is declared simply as unsigned. There is one special value. */</span>
<a name="l00077"></a><a class="code" href="ccnd__strategy_8h.html#aa065f01949d39e9cdf018f197151995e">00077</a> <span class="preprocessor">#define CCN_NOFACEID    (~0U)    </span><span class="comment">/** denotes no face */</span>
<a name="l00078"></a>00078 
<a name="l00079"></a><a class="code" href="ccnd__strategy_8h.html#a3cd5d88d70af91c5a879e333b2f1e2b3">00079</a> <span class="preprocessor">#define TYPICAL_NONCE_SIZE 12       </span><span class="comment">/**&lt; actual allocated size may differ */</span>
<a name="l00080"></a>00080 <span class="comment">/**</span>
<a name="l00081"></a>00081 <span class="comment"> * Per-face PIT information</span>
<a name="l00082"></a>00082 <span class="comment"> *</span>
<a name="l00083"></a>00083 <span class="comment"> * This is used to track the pending interest info that is specific to</span>
<a name="l00084"></a>00084 <span class="comment"> * a face.  The list may contain up to two entries for a given face - one</span>
<a name="l00085"></a>00085 <span class="comment"> * to track the most recent arrival on that face (the downstream), and</span>
<a name="l00086"></a>00086 <span class="comment"> * one to track the most recently sent (the upstream).</span>
<a name="l00087"></a>00087 <span class="comment"> */</span>
<a name="l00088"></a>00088 
<a name="l00089"></a><a class="code" href="structpit__face__item.html">00089</a> <span class="keyword">struct </span><a class="code" href="structpit__face__item.html" title="Per-face PIT information.">pit_face_item</a> {
<a name="l00090"></a><a class="code" href="structpit__face__item.html#a96a22373c1209ce80d061bc7aa49bd54">00090</a>     <span class="keyword">struct </span><a class="code" href="structpit__face__item.html" title="Per-face PIT information.">pit_face_item</a> *<a class="code" href="structpit__face__item.html#a96a22373c1209ce80d061bc7aa49bd54" title="next in list">next</a>;     <span class="comment">/**&lt; next in list */</span>
<a name="l00091"></a><a class="code" href="structpit__face__item.html#a30c58888494549639058af24184bdab4">00091</a>     <span class="keywordtype">unsigned</span> <a class="code" href="structpit__face__item.html#a30c58888494549639058af24184bdab4" title="face id">faceid</a>;                <span class="comment">/**&lt; face id */</span>
<a name="l00092"></a><a class="code" href="structpit__face__item.html#acee13a66031ebbb4a8ae95ad41d184ea">00092</a>     <a class="code" href="ccnd__strategy_8h.html#a5a898d6229f4c0146bd54fd8240e05bf" title="Used for keeping track of interest expiry.">ccn_wrappedtime</a> <a class="code" href="structpit__face__item.html#acee13a66031ebbb4a8ae95ad41d184ea" title="when entry was last refreshed">renewed</a>;        <span class="comment">/**&lt; when entry was last refreshed */</span>
<a name="l00093"></a><a class="code" href="structpit__face__item.html#aaf48d235b7c81384e033e9e2fdc8564c">00093</a>     <a class="code" href="ccnd__strategy_8h.html#a5a898d6229f4c0146bd54fd8240e05bf" title="Used for keeping track of interest expiry.">ccn_wrappedtime</a> <a class="code" href="structpit__face__item.html#aaf48d235b7c81384e033e9e2fdc8564c" title="when entry expires">expiry</a>;         <span class="comment">/**&lt; when entry expires */</span>
<a name="l00094"></a><a class="code" href="structpit__face__item.html#ab3b6c6eb0f9e3abdea0e5bbcdf879268">00094</a>     <span class="keywordtype">unsigned</span> <a class="code" href="structpit__face__item.html#ab3b6c6eb0f9e3abdea0e5bbcdf879268" title="CCND_PFI_x.">pfi_flags</a>;             <span class="comment">/**&lt; CCND_PFI_x */</span>
<a name="l00095"></a><a class="code" href="structpit__face__item.html#a45d307b516be7d35e96a2a8111b7e46d">00095</a>     <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structpit__face__item.html#a45d307b516be7d35e96a2a8111b7e46d" title="nonce bytes">nonce</a>[<a class="code" href="ccnd__strategy_8h.html#a3cd5d88d70af91c5a879e333b2f1e2b3" title="actual allocated size may differ">TYPICAL_NONCE_SIZE</a>]; <span class="comment">/**&lt; nonce bytes */</span>
<a name="l00096"></a>00096 };
<a name="l00097"></a><a class="code" href="ccnd__strategy_8h.html#afe8bf8f48154faf3c30c8deaaf76d4e5">00097</a> <span class="preprocessor">#define CCND_PFI_NONCESZ  0x00FF    </span><span class="comment">/**&lt; Mask for actual nonce size */</span>
<a name="l00098"></a><a class="code" href="ccnd__strategy_8h.html#a98a780cecc065b059cd6c6b653374d8f">00098</a> <span class="preprocessor">#define CCND_PFI_UPSTREAM 0x0100    </span><span class="comment">/**&lt; Tracks upstream (sent interest) */</span>
<a name="l00099"></a><a class="code" href="ccnd__strategy_8h.html#acae75fb92570d09940af4714493d7c60">00099</a> <span class="preprocessor">#define CCND_PFI_UPENDING 0x0200    </span><span class="comment">/**&lt; Has been sent upstream (initially cleared, set for tap face) */</span>
<a name="l00100"></a><a class="code" href="ccnd__strategy_8h.html#a6ffae7cc30e38561f1d440279cb22d00">00100</a> <span class="preprocessor">#define CCND_PFI_SENDUPST 0x0400    </span><span class="comment">/**&lt; Should be sent upstream (send upstream at expiry) */</span>
<a name="l00101"></a><a class="code" href="ccnd__strategy_8h.html#a16ffc7b766834017751e5344e09fc7f5">00101</a> <span class="preprocessor">#define CCND_PFI_UPHUNGRY 0x0800    </span><span class="comment">/**&lt; Upstream hungry, cupboard bare (upstream expired, no unexpired downstream to refresh) */</span>
<a name="l00102"></a><a class="code" href="ccnd__strategy_8h.html#ad7c32365c965a04119346851fea184e1">00102</a> <span class="preprocessor">#define CCND_PFI_DNSTREAM 0x1000    </span><span class="comment">/**&lt; Tracks downstream (recvd interest) */</span>
<a name="l00103"></a><a class="code" href="ccnd__strategy_8h.html#a6ef9552de8945db03fa8d6a270f372aa">00103</a> <span class="preprocessor">#define CCND_PFI_PENDING  0x2000    </span><span class="comment">/**&lt; Pending for immediate data */</span>
<a name="l00104"></a><a class="code" href="ccnd__strategy_8h.html#a671f091f9ca07b887363460983ea2aa8">00104</a> <span class="preprocessor">#define CCND_PFI_SUPDATA  0x4000    </span><span class="comment">/**&lt; Suppressed data reply */</span>
<a name="l00105"></a><a class="code" href="ccnd__strategy_8h.html#a54769f934bdc971913d575ac96587b43">00105</a> <span class="preprocessor">#define CCND_PFI_ATTENTION 0x10000  </span><span class="comment">/**&lt; Upstream needs attention from strategy */</span>
<a name="l00106"></a><a class="code" href="ccnd__strategy_8h.html#af70376618c417d0d01afea85aeb5bfb9">00106</a> <span class="preprocessor">#define CCND_PFI_INACTIVE 0x20000   </span><span class="comment">/**&lt; Face is nonresponsive, may have lost communication */</span>
<a name="l00107"></a><a class="code" href="ccnd__strategy_8h.html#a4556cedfaea08630e78dec94dae06e48">00107</a> <span class="preprocessor">#define CCND_PFI_DCFACE 0x100000    </span><span class="comment">/**&lt; This upstream is a Direct Control face (gets data if unanswered for a long time) */</span>
<a name="l00108"></a>00108 <span class="comment"></span>
<a name="l00109"></a>00109 <span class="comment">/**</span>
<a name="l00110"></a>00110 <span class="comment"> * State for the strategy engine</span>
<a name="l00111"></a>00111 <span class="comment"> *</span>
<a name="l00112"></a>00112 <span class="comment"> * This is associated with each PIT entry, and keeps track of the associated</span>
<a name="l00113"></a>00113 <span class="comment"> * upstream and downstream faces.</span>
<a name="l00114"></a>00114 <span class="comment"> */</span>
<a name="l00115"></a><a class="code" href="structccn__strategy.html">00115</a> <span class="keyword">struct </span><a class="code" href="structccn__strategy.html" title="State for the strategy engine.">ccn_strategy</a> {
<a name="l00116"></a><a class="code" href="structccn__strategy.html#a33536e249190a9f92d943425d3e72878">00116</a>     <span class="keyword">struct </span><a class="code" href="structpit__face__item.html" title="Per-face PIT information.">pit_face_item</a> *<a class="code" href="structccn__strategy.html#a33536e249190a9f92d943425d3e72878" title="upstream and downstream faces">pfl</a>;      <span class="comment">/**&lt; upstream and downstream faces */</span>
<a name="l00117"></a><a class="code" href="structccn__strategy.html#a1b190f4612941e7a26f8fa55d17e3ff8">00117</a>     <a class="code" href="ccnd__strategy_8h.html#a5a898d6229f4c0146bd54fd8240e05bf" title="Used for keeping track of interest expiry.">ccn_wrappedtime</a> <a class="code" href="structccn__strategy.html#a1b190f4612941e7a26f8fa55d17e3ff8" title="when interest entry was created">birth</a>;          <span class="comment">/**&lt; when interest entry was created */</span>
<a name="l00118"></a><a class="code" href="structccn__strategy.html#a2903802b2fa81717d317f0e551b29c1a">00118</a>     <a class="code" href="ccnd__strategy_8h.html#a5a898d6229f4c0146bd54fd8240e05bf" title="Used for keeping track of interest expiry.">ccn_wrappedtime</a> <a class="code" href="structccn__strategy.html#a2903802b2fa81717d317f0e551b29c1a" title="when interest entry was renewed">renewed</a>;        <span class="comment">/**&lt; when interest entry was renewed */</span>
<a name="l00119"></a><a class="code" href="structccn__strategy.html#ae9a58126b08434585a69eed41f6c5a54">00119</a>     <span class="keywordtype">unsigned</span> <a class="code" href="structccn__strategy.html#ae9a58126b08434585a69eed41f6c5a54" title="number of times renewed">renewals</a>;              <span class="comment">/**&lt; number of times renewed */</span>
<a name="l00120"></a><a class="code" href="structccn__strategy.html#a4c5928d4f3ef5fc0618537c40e7fec30">00120</a>     <span class="keyword">struct </span><a class="code" href="structinterest__entry.html" title="The interest hash table is keyed by the interest message.">interest_entry</a> *<a class="code" href="structccn__strategy.html#a4c5928d4f3ef5fc0618537c40e7fec30" title="associated interest entry">ie</a>;      <span class="comment">/**&lt; associated interest entry */</span>
<a name="l00121"></a>00121 };
<a name="l00122"></a>00122 <span class="comment"></span>
<a name="l00123"></a>00123 <span class="comment">/**</span>
<a name="l00124"></a>00124 <span class="comment"> * Ops for strategy callout</span>
<a name="l00125"></a>00125 <span class="comment"> *</span>
<a name="l00126"></a>00126 <span class="comment"> * These are passed to the strategy callout to inform it of the current</span>
<a name="l00127"></a>00127 <span class="comment"> * situation.</span>
<a name="l00128"></a>00128 <span class="comment"> *</span>
<a name="l00129"></a>00129 <span class="comment"> * CCNST_NOP        is useful as an argument to pass to strategy_settimer()</span>
<a name="l00130"></a>00130 <span class="comment"> *                  when the callout wishes to cancel a pending strategy</span>
<a name="l00131"></a>00131 <span class="comment"> *                  timer.  CCNST_NOP is not expected to actually be passed</span>
<a name="l00132"></a>00132 <span class="comment"> *                  to a callout, but if it is, the strategy should take</span>
<a name="l00133"></a>00133 <span class="comment"> *                  no action that changes forwarding behavior.</span>
<a name="l00134"></a>00134 <span class="comment"> *</span>
<a name="l00135"></a>00135 <span class="comment"> * CCNST_INIT       provides an opportunity for the callout to allocate</span>
<a name="l00136"></a>00136 <span class="comment"> *                  and initialize any private instance state that it may</span>
<a name="l00137"></a>00137 <span class="comment"> *                  require.  This happens when a new strategy is attached to</span>
<a name="l00138"></a>00138 <span class="comment"> *                  a given prefix.  If the strategy uses parameters, this</span>
<a name="l00139"></a>00139 <span class="comment"> *                  call is the appropriate time to parse them and save the</span>
<a name="l00140"></a>00140 <span class="comment"> *                  resulting values in the private instance state for</span>
<a name="l00141"></a>00141 <span class="comment"> *                  rapid access in the more time-critical calls.</span>
<a name="l00142"></a>00142 <span class="comment"> *                  The callout should use strategy_init_error() to report</span>
<a name="l00143"></a>00143 <span class="comment"> *                  problems with the parameter string.</span>
<a name="l00144"></a>00144 <span class="comment"> *</span>
<a name="l00145"></a>00145 <span class="comment"> * CCNST_FIRST      indicates the creation of a new PIT entry due to an</span>
<a name="l00146"></a>00146 <span class="comment"> *                  arriving interest.  Since there was no existing state</span>
<a name="l00147"></a>00147 <span class="comment"> *                  for similar interests, there will be exactly one</span>
<a name="l00148"></a>00148 <span class="comment"> *                  downstream in the pfi list.  The upstreams in the list</span>
<a name="l00149"></a>00149 <span class="comment"> *                  are those that the FIB has indicated are eligible to</span>
<a name="l00150"></a>00150 <span class="comment"> *                  receive the interests.</span>
<a name="l00151"></a>00151 <span class="comment"> *                  The expiry times are initially set to the current time,</span>
<a name="l00152"></a>00152 <span class="comment"> *                  so if the strategy callout sets CCND_PFI_SENDUPST on,</span>
<a name="l00153"></a>00153 <span class="comment"> *                  an upstream, the interest will be sent to the marked</span>
<a name="l00154"></a>00154 <span class="comment"> *                  upstreams as soon as the callout returns.</span>
<a name="l00155"></a>00155 <span class="comment"> *                  At the time of the CCNST_FIRST call, some upstreams may have</span>
<a name="l00156"></a>00156 <span class="comment"> *                  already been fed (such as those with the TAP forwarding</span>
<a name="l00157"></a>00157 <span class="comment"> *                  flag).  These will have CCND_PFI_UPENDING set.</span>
<a name="l00158"></a>00158 <span class="comment"> *                  The strategy callout should generally ignore such entries.</span>
<a name="l00159"></a>00159 <span class="comment"> *                  The faceid indicates the initial downstream face.</span>
<a name="l00160"></a>00160 <span class="comment"> *</span>
<a name="l00161"></a>00161 <span class="comment"> * CCNST_UPDATE     indicates at least one upstream has become eligible</span>
<a name="l00162"></a>00162 <span class="comment"> *                  receive a new copy of the interest, because any previously</span>
<a name="l00163"></a>00163 <span class="comment"> *                  sent interest has expired and an unexpired downsream is</span>
<a name="l00164"></a>00164 <span class="comment"> *                  available; or a new upstream has been added,</span>
<a name="l00165"></a>00165 <span class="comment"> *                  because of a new prefix registration, or because</span>
<a name="l00166"></a>00166 <span class="comment"> *                  a second downstream has made the initial upstream</span>
<a name="l00167"></a>00167 <span class="comment"> *                  eligible.  The affected upstreams will have</span>
<a name="l00168"></a>00168 <span class="comment"> *                  CCND_PFI_ATTENTION set and an expiry in the near future.</span>
<a name="l00169"></a>00169 <span class="comment"> *                  For these entries, the strategy must</span>
<a name="l00170"></a>00170 <span class="comment"> *                  clear CCND_PFI_ATTENTION and may choose to set</span>
<a name="l00171"></a>00171 <span class="comment"> *                  CCND_PFI_SENDUPST on the subset of the affected upstreams</span>
<a name="l00172"></a>00172 <span class="comment"> *                  that it selects.</span>
<a name="l00173"></a>00173 <span class="comment"> *                  The value of faceid is not interesting.</span>
<a name="l00174"></a>00174 <span class="comment"> *</span>
<a name="l00175"></a>00175 <span class="comment"> * CCNST_EXPUP      indicates an upstream is expiring. This happens when and</span>
<a name="l00176"></a>00176 <span class="comment"> *                  only when an interest has been sent to the upstream face</span>
<a name="l00177"></a>00177 <span class="comment"> *                  and the associated lifetime has elapsed without the</span>
<a name="l00178"></a>00178 <span class="comment"> *                  receipt of matching content.</span>
<a name="l00179"></a>00179 <span class="comment"> *                  The faceid indicates the expiring upstream face.</span>
<a name="l00180"></a>00180 <span class="comment"> *</span>
<a name="l00181"></a>00181 <span class="comment"> * CCNST_EXPDN      indicates the downstream is expiring.</span>
<a name="l00182"></a>00182 <span class="comment"> *                  The faceid indicates the expiring downstream face.</span>
<a name="l00183"></a>00183 <span class="comment"> *</span>
<a name="l00184"></a>00184 <span class="comment"> * CCNST_REFRESH    indicates a new, similar, interest message has arrived.</span>
<a name="l00185"></a>00185 <span class="comment"> *                  a previously existing downstream face.  Its expiry</span>
<a name="l00186"></a>00186 <span class="comment"> *                  Its expiry will have been updated accordingly.  The strategy</span>
<a name="l00187"></a>00187 <span class="comment"> *                  likely does not need to do anything special with this</span>
<a name="l00188"></a>00188 <span class="comment"> *                  case, because it will get separate calls for each of</span>
<a name="l00189"></a>00189 <span class="comment"> *                  the upstreams when their respective expiries occur.</span>
<a name="l00190"></a>00190 <span class="comment"> *                  The faceid indicates the refreshed downstream face.</span>
<a name="l00191"></a>00191 <span class="comment"> *</span>
<a name="l00192"></a>00192 <span class="comment"> * CCNST_TIMER      is intended as an argument for strategy_settimer()</span>
<a name="l00193"></a>00193 <span class="comment"> *                  so that the strategy callout can get control at a time</span>
<a name="l00194"></a>00194 <span class="comment"> *                  that does not need to correspond with the expiry of</span>
<a name="l00195"></a>00195 <span class="comment"> *                  an upstream or downstream.</span>
<a name="l00196"></a>00196 <span class="comment"> *                  The value of faceid is not interesting.</span>
<a name="l00197"></a>00197 <span class="comment"> *</span>
<a name="l00198"></a>00198 <span class="comment"> * CCNST_SATISFIED  indicates the arrival of a matching content object.</span>
<a name="l00199"></a>00199 <span class="comment"> *                  After the strategy callout returns, all of the</span>
<a name="l00200"></a>00200 <span class="comment"> *                  downstreams that have CCND_PFI_PENDING set will</span>
<a name="l00201"></a>00201 <span class="comment"> *                  be sent copies of the data, and the PIT entry will</span>
<a name="l00202"></a>00202 <span class="comment"> *                  be removed.</span>
<a name="l00203"></a>00203 <span class="comment"> *                  The faceid indicates the source of the matching content.</span>
<a name="l00204"></a>00204 <span class="comment"> *</span>
<a name="l00205"></a>00205 <span class="comment"> * CCNST_TIMEOUT    indicates that all downstreams and upstreams have expired.</span>
<a name="l00206"></a>00206 <span class="comment"> *                  The PIT entry will go away as soon as the callout returns.</span>
<a name="l00207"></a>00207 <span class="comment"> *                  The value of faceid is not interesting.</span>
<a name="l00208"></a>00208 <span class="comment"> *</span>
<a name="l00209"></a>00209 <span class="comment"> * CCNST_FINALIZE   indicates the strategy instance is about to go away.</span>
<a name="l00210"></a>00210 <span class="comment"> *                  The strategy callout should deallocate any</span>
<a name="l00211"></a>00211 <span class="comment"> *                  strategy-private memory.</span>
<a name="l00212"></a>00212 <span class="comment"> *                  The value of faceid is not interesting.</span>
<a name="l00213"></a>00213 <span class="comment"> */</span>
<a name="l00214"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431a">00214</a> <span class="keyword">enum</span> <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431a" title="Ops for strategy callout.">ccn_strategy_op</a> {
<a name="l00215"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aac03941ac0412788f060c52be61922e9a">00215</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aac03941ac0412788f060c52be61922e9a">CCNST_NOP</a>,      <span class="comment">/* no-operation */</span>
<a name="l00216"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aa8813d62dd1a8ce26ccbd3d1e3da7e593">00216</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aa8813d62dd1a8ce26ccbd3d1e3da7e593">CCNST_INIT</a>,     <span class="comment">/* initialize strategy, allocate instance state */</span>
<a name="l00217"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aac0265edccb3f758a0b09ac616e60c79a">00217</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aac0265edccb3f758a0b09ac616e60c79a">CCNST_FIRST</a>,    <span class="comment">/* newly created interest entry (pit entry) */</span>
<a name="l00218"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aaea4cf6d30ef2cf4e2e8b3e21d150e8cc">00218</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aaea4cf6d30ef2cf4e2e8b3e21d150e8cc">CCNST_UPDATE</a>,   <span class="comment">/* select upstreams to feed */</span>
<a name="l00219"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aa2dbe29da268e667edfc5c641dc95d11b">00219</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aa2dbe29da268e667edfc5c641dc95d11b">CCNST_EXPUP</a>,    <span class="comment">/* upstream is expiring */</span>
<a name="l00220"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aabe4703e21bf65a3a4d1f74b69506c44b">00220</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aabe4703e21bf65a3a4d1f74b69506c44b">CCNST_EXPDN</a>,    <span class="comment">/* downstream is expiring */</span>
<a name="l00221"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aabdad6ed372cf76550f459f2a07bc3088">00221</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aabdad6ed372cf76550f459f2a07bc3088">CCNST_REFRESH</a>,  <span class="comment">/* downstream refreshed */</span>
<a name="l00222"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aa187a2d21896a792ff501c9d7dd82da98">00222</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aa187a2d21896a792ff501c9d7dd82da98">CCNST_TIMER</a>,    <span class="comment">/* wakeup used by strategy */</span>
<a name="l00223"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aa13e6355a9c429de7b52e12deed0d1fad">00223</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aa13e6355a9c429de7b52e12deed0d1fad">CCNST_SATISFIED</a>, <span class="comment">/* matching content has arrived, pit entry will go away */</span>
<a name="l00224"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aae0e1f6063bc8fa18c484086a7789868b">00224</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aae0e1f6063bc8fa18c484086a7789868b">CCNST_TIMEOUT</a>,  <span class="comment">/* all downstreams timed out, pit entry will go away */</span>
<a name="l00225"></a><a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aa0f697017e4950b8c284c11be2fe08984">00225</a>     <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431aa0f697017e4950b8c284c11be2fe08984">CCNST_FINALIZE</a>, <span class="comment">/* destroy instance state */</span>
<a name="l00226"></a>00226 };
<a name="l00227"></a>00227 <span class="comment"></span>
<a name="l00228"></a>00228 <span class="comment">/**</span>
<a name="l00229"></a>00229 <span class="comment"> *</span>
<a name="l00230"></a>00230 <span class="comment"> * Strategies are implemented by a procedure that is called at</span>
<a name="l00231"></a>00231 <span class="comment"> * critical junctures in the lifetime of a pending interest.</span>
<a name="l00232"></a>00232 <span class="comment"> *</span>
<a name="l00233"></a>00233 <span class="comment"> * If op is CCNST_FIRST, faceid tells the interest arrival face (downstream).</span>
<a name="l00234"></a>00234 <span class="comment"> * If op is CCNST_SATISFIED, faceid tells the content arrival face (upstream).</span>
<a name="l00235"></a>00235 <span class="comment"> *</span>
<a name="l00236"></a>00236 <span class="comment"> */</span>
<a name="l00237"></a><a class="code" href="ccnd__strategy_8h.html#a406126c9244bf51137cf27f3b1fc5e82">00237</a> <span class="keyword">typedef</span> void (*<a class="code" href="ccnd__strategy_8h.html#a406126c9244bf51137cf27f3b1fc5e82" title="Strategies are implemented by a procedure that is called at critical junctures in the lifetime of a p...">strategy_callout_proc</a>)(<span class="keyword">struct </span><a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h,
<a name="l00238"></a>00238                                       <span class="keyword">struct </span><a class="code" href="structstrategy__instance.html">strategy_instance</a> *instance,
<a name="l00239"></a>00239                                       <span class="keyword">struct </span><a class="code" href="structccn__strategy.html" title="State for the strategy engine.">ccn_strategy</a> *s,
<a name="l00240"></a>00240                                       <span class="keyword">enum</span> <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431a" title="Ops for strategy callout.">ccn_strategy_op</a> op,
<a name="l00241"></a>00241                                       <span class="keywordtype">unsigned</span> faceid);
<a name="l00242"></a>00242 
<a name="l00243"></a><a class="code" href="structstrategy__class.html">00243</a> <span class="keyword">struct </span><a class="code" href="structstrategy__class.html">strategy_class</a> {
<a name="l00244"></a><a class="code" href="structstrategy__class.html#abcd6c33ab42f9e7400eadcafc466e0fe">00244</a>     <span class="keywordtype">char</span> <span class="keywordtype">id</span>[16];                   <span class="comment">/* The name of the strategy */</span>
<a name="l00245"></a><a class="code" href="structstrategy__class.html#a1be66aca0ae278155160f7f4c3f0741d">00245</a>     <a class="code" href="ccnd__strategy_8h.html#a406126c9244bf51137cf27f3b1fc5e82" title="Strategies are implemented by a procedure that is called at critical junctures in the lifetime of a p...">strategy_callout_proc</a> <a class="code" href="structstrategy__class.html#a1be66aca0ae278155160f7f4c3f0741d">callout</a>; <span class="comment">/* procedure implementing the strategy */</span>
<a name="l00246"></a>00246 };
<a name="l00247"></a>00247 
<a name="l00248"></a><a class="code" href="structstrategy__instance.html">00248</a> <span class="keyword">struct </span><a class="code" href="structstrategy__instance.html">strategy_instance</a> {
<a name="l00249"></a><a class="code" href="structstrategy__instance.html#afe040f4a59db31bf50c7c030d545b67f">00249</a>     <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structstrategy__class.html">strategy_class</a> *<a class="code" href="structstrategy__instance.html#afe040f4a59db31bf50c7c030d545b67f">sclass</a>; <span class="comment">/* strategy class */</span>
<a name="l00250"></a><a class="code" href="structstrategy__instance.html#aa3dae5643b457ac08b6ba5a20eeacb95">00250</a>     <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structstrategy__instance.html#aa3dae5643b457ac08b6ba5a20eeacb95">parameters</a>;              <span class="comment">/* passed in from outside */</span>
<a name="l00251"></a><a class="code" href="structstrategy__instance.html#a6032b69bd3a3a734449a576c9de0f10e">00251</a>     <span class="keywordtype">void</span> *<a class="code" href="structstrategy__instance.html#a6032b69bd3a3a734449a576c9de0f10e">data</a>;                          <span class="comment">/* strategy private data */</span>
<a name="l00252"></a><a class="code" href="structstrategy__instance.html#a071ee68aee268fc069fa2ecec959a99f">00252</a>     <span class="keyword">struct </span><a class="code" href="structnameprefix__entry.html" title="The nameprefix hash table is keyed by the Component elements of the Name prefix.">nameprefix_entry</a> *<a class="code" href="structstrategy__instance.html#a071ee68aee268fc069fa2ecec959a99f">npe</a>;        <span class="comment">/* where strategy is registered */</span>
<a name="l00253"></a>00253 };
<a name="l00254"></a>00254 <span class="comment"></span>
<a name="l00255"></a>00255 <span class="comment">/**</span>
<a name="l00256"></a>00256 <span class="comment"> *  Note a strategy initialization error</span>
<a name="l00257"></a>00257 <span class="comment"> *</span>
<a name="l00258"></a>00258 <span class="comment"> * A call to this during the CCNST_INIT callout will do appropriate</span>
<a name="l00259"></a>00259 <span class="comment"> * logging and error reporting, and cause the instance to be removed after</span>
<a name="l00260"></a>00260 <span class="comment"> * the termination of the intialization callout.</span>
<a name="l00261"></a>00261 <span class="comment"> *</span>
<a name="l00262"></a>00262 <span class="comment"> * Do not call from other contexts.</span>
<a name="l00263"></a>00263 <span class="comment"> */</span>
<a name="l00264"></a>00264 <span class="keywordtype">void</span> <a class="code" href="ccnd_8c.html#a0fe20ed339cc78350d1bbb25f6bbbb9a" title="Report a strategy initialization failure.">strategy_init_error</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h,
<a name="l00265"></a>00265                          <span class="keyword">struct</span> <a class="code" href="structstrategy__instance.html">strategy_instance</a> *instance,
<a name="l00266"></a>00266                          <span class="keyword">const</span> <span class="keywordtype">char</span> *message);<span class="comment"></span>
<a name="l00267"></a>00267 <span class="comment">/**</span>
<a name="l00268"></a>00268 <span class="comment"> *  Forward an interest message</span>
<a name="l00269"></a>00269 <span class="comment"> *</span>
<a name="l00270"></a>00270 <span class="comment"> *  The strategy routine may choose to call this directly, and/or</span>
<a name="l00271"></a>00271 <span class="comment"> *  update the pfi entries so that the interest will be forwarded</span>
<a name="l00272"></a>00272 <span class="comment"> *  on a schedule.  If send_interest is called, p is updated to</span>
<a name="l00273"></a>00273 <span class="comment"> *  reflect the new state.</span>
<a name="l00274"></a>00274 <span class="comment"> *</span>
<a name="l00275"></a>00275 <span class="comment"> *  x is downstream (the interest came from x).</span>
<a name="l00276"></a>00276 <span class="comment"> *  p is upstream (the interest is to be forwarded to p).</span>
<a name="l00277"></a>00277 <span class="comment"> *  @returns p (or its reallocated replacement).</span>
<a name="l00278"></a>00278 <span class="comment"> */</span>
<a name="l00279"></a>00279 <span class="keyword">struct </span><a class="code" href="structpit__face__item.html" title="Per-face PIT information.">pit_face_item</a> *
<a name="l00280"></a>00280 <a class="code" href="ccnd_8c.html#a438b5b537d346cf8782bc02d6afb6b0d" title="Forward an interest message.">send_interest</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keyword">struct</span> <a class="code" href="structinterest__entry.html" title="The interest hash table is keyed by the interest message.">interest_entry</a> *ie,
<a name="l00281"></a>00281               <span class="keyword">struct</span> <a class="code" href="structpit__face__item.html" title="Per-face PIT information.">pit_face_item</a> *x, <span class="keyword">struct</span> <a class="code" href="structpit__face__item.html" title="Per-face PIT information.">pit_face_item</a> *p);
<a name="l00282"></a>00282 <span class="comment"></span>
<a name="l00283"></a>00283 <span class="comment">/**</span>
<a name="l00284"></a>00284 <span class="comment"> * Set the expiry of the pit face item using a time in microseconds from present</span>
<a name="l00285"></a>00285 <span class="comment"> *</span>
<a name="l00286"></a>00286 <span class="comment"> * Does not set the renewed timestamp.</span>
<a name="l00287"></a>00287 <span class="comment"> */</span>
<a name="l00288"></a>00288 <span class="keywordtype">void</span>
<a name="l00289"></a>00289 <a class="code" href="ccnd_8c.html#a155b315c6790b22661c63f7489414ddc" title="Set the expiry of the pit face item using a time in microseconds from present.">pfi_set_expiry_from_micros</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keyword">struct</span> <a class="code" href="structinterest__entry.html" title="The interest hash table is keyed by the interest message.">interest_entry</a> *ie,
<a name="l00290"></a>00290                            <span class="keyword">struct</span> <a class="code" href="structpit__face__item.html" title="Per-face PIT information.">pit_face_item</a> *p, <span class="keywordtype">unsigned</span> micros);
<a name="l00291"></a>00291 <span class="comment"></span>
<a name="l00292"></a>00292 <span class="comment">/**</span>
<a name="l00293"></a>00293 <span class="comment"> * Return a pointer to the strategy state records for</span>
<a name="l00294"></a>00294 <span class="comment"> * the name prefix of the given interest entry and up to k-1 parents.</span>
<a name="l00295"></a>00295 <span class="comment"> *</span>
<a name="l00296"></a>00296 <span class="comment"> * The sst array is filled in; NULL values are provided as needed.</span>
<a name="l00297"></a>00297 <span class="comment"> * The item sst[0] corresponds with the name inside the interest, and is</span>
<a name="l00298"></a>00298 <span class="comment"> * never NULL unless s is NULL.</span>
<a name="l00299"></a>00299 <span class="comment"> * The remaining entries are for successively shorter prefixes.</span>
<a name="l00300"></a>00300 <span class="comment"> */</span>
<a name="l00301"></a>00301 <span class="keywordtype">void</span> <a class="code" href="ccnd_8c.html#ab8172a53fe10dd55cd16636abfdd0d41" title="Return a pointer to the strategy state records for the name prefix of the given interest entry and up...">strategy_getstate</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keyword">struct</span> <a class="code" href="structccn__strategy.html" title="State for the strategy engine.">ccn_strategy</a> *s,
<a name="l00302"></a>00302                        <span class="keyword">struct</span> <a class="code" href="structnameprefix__state.html" title="This is a place for strategies to record state that is attached to a given name prefix.">nameprefix_state</a> **sst, <span class="keywordtype">int</span> k);
<a name="l00303"></a>00303 <span class="comment"></span>
<a name="l00304"></a>00304 <span class="comment">/**</span>
<a name="l00305"></a>00305 <span class="comment"> * Schedule a strategy wakeup</span>
<a name="l00306"></a>00306 <span class="comment"> *</span>
<a name="l00307"></a>00307 <span class="comment"> * This causes the associated strategy callout to be called at</span>
<a name="l00308"></a>00308 <span class="comment"> * a later time.  The op will be passed to the deferred invocation.</span>
<a name="l00309"></a>00309 <span class="comment"> *</span>
<a name="l00310"></a>00310 <span class="comment"> * Any previously scheduled wakeup will be cancelled.</span>
<a name="l00311"></a>00311 <span class="comment"> * To just cancel any existing wakeup, pass CCNST_NOP.</span>
<a name="l00312"></a>00312 <span class="comment"> */</span>
<a name="l00313"></a>00313 <span class="keywordtype">void</span> <a class="code" href="ccnd_8c.html#aa5928d724fd3eec661f7e4d388b5540a" title="Schedule a strategy wakeup.">strategy_settimer</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keyword">struct</span> <a class="code" href="structinterest__entry.html" title="The interest hash table is keyed by the interest message.">interest_entry</a> *ie,
<a name="l00314"></a>00314                        <span class="keywordtype">int</span> usec, <span class="keyword">enum</span> <a class="code" href="ccnd__strategy_8h.html#a60472547f4439f0da14fb383b6c9431a" title="Ops for strategy callout.">ccn_strategy_op</a> op);
<a name="l00315"></a>00315 <span class="comment"></span>
<a name="l00316"></a>00316 <span class="comment">/**</span>
<a name="l00317"></a>00317 <span class="comment"> * Get the face handle for a given faceid</span>
<a name="l00318"></a>00318 <span class="comment"> *</span>
<a name="l00319"></a>00319 <span class="comment"> * Strategy routines should use the accessors provided.</span>
<a name="l00320"></a>00320 <span class="comment"> *</span>
<a name="l00321"></a>00321 <span class="comment"> * @returns NULL if face does not exist.</span>
<a name="l00322"></a>00322 <span class="comment"> */</span>
<a name="l00323"></a>00323 <span class="keyword">struct </span><a class="code" href="structface.html" title="One of our active faces.">face</a> *<a class="code" href="ccnd_8c.html#aeccb0edccd5bfbab65ac192403fbe8dc" title="Looks up a face based on its faceid.">ccnd_face_from_faceid</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *, <span class="keywordtype">unsigned</span>);
<a name="l00324"></a>00324 <span class="comment"></span>
<a name="l00325"></a>00325 <span class="comment">/** Accessors for things a strategy might want to know about a face. */</span>
<a name="l00326"></a>00326 <span class="keywordtype">unsigned</span> <a class="code" href="ccnd_8c.html#ad79f06543f0e8c30c7c9b458bbd687ad" title="Accessor for faceid.">face_faceid</a>(<span class="keyword">struct</span> <a class="code" href="structface.html" title="One of our active faces.">face</a> *);
<a name="l00327"></a>00327 <span class="keywordtype">int</span> <a class="code" href="ccnd_8c.html#a0d8e970bc97017b9edc3f941c5e40788" title="Accessor for number of pending interests received on a face.">face_pending_interests</a>(<span class="keyword">struct</span> <a class="code" href="structface.html" title="One of our active faces.">face</a> *);
<a name="l00328"></a>00328 <span class="keywordtype">int</span> <a class="code" href="ccnd_8c.html#a5206b73f856fd8f08cd6ffb45db0cb97" title="Accessor for number of outstanding interests sent on a face.">face_outstanding_interests</a>(<span class="keyword">struct</span> <a class="code" href="structface.html" title="One of our active faces.">face</a> *);
<a name="l00329"></a>00329 <span class="comment"></span>
<a name="l00330"></a>00330 <span class="comment">/**</span>
<a name="l00331"></a>00331 <span class="comment"> * Face attributes</span>
<a name="l00332"></a>00332 <span class="comment"> *</span>
<a name="l00333"></a>00333 <span class="comment"> * To help strategies do their work, there is provision for faces to carry</span>
<a name="l00334"></a>00334 <span class="comment"> * a collection of attributes.  These have associated values, which can be</span>
<a name="l00335"></a>00335 <span class="comment"> * either boolean or numeric (non-negative integers).  Strategies may set</span>
<a name="l00336"></a>00336 <span class="comment"> * and get these values using an attribute index to say which attribute is</span>
<a name="l00337"></a>00337 <span class="comment"> * desired.  Some attributes are set by ccnd, based upon things it</span>
<a name="l00338"></a>00338 <span class="comment"> * knows about the face.  Others have associated names, and may be set from</span>
<a name="l00339"></a>00339 <span class="comment"> * the outside (using the face managment protocol).  Still others are private</span>
<a name="l00340"></a>00340 <span class="comment"> * to strategy implementations, and need not have a name, only a dynamically</span>
<a name="l00341"></a>00341 <span class="comment"> * assigned index.</span>
<a name="l00342"></a>00342 <span class="comment"> *</span>
<a name="l00343"></a>00343 <span class="comment"> * The first 32 indices (0 through 31) are reserved for single-bit attributes.</span>
<a name="l00344"></a>00344 <span class="comment"> * These may be read all at once using faceattr_get_packed, but are set using</span>
<a name="l00345"></a>00345 <span class="comment"> * the general faceattr_set call.  They may also be read using faceattr_get.</span>
<a name="l00346"></a>00346 <span class="comment"> * In the packed form, the attribute with index 0 is stored in the low-order</span>
<a name="l00347"></a>00347 <span class="comment"> * bit, so the bits may be tested using straightforward shifts and masks.</span>
<a name="l00348"></a>00348 <span class="comment"> * After the first 32 single-bit attributes have been created, any additional</span>
<a name="l00349"></a>00349 <span class="comment"> * requests will be fullfulled with attributes capable of carrying numeric</span>
<a name="l00350"></a>00350 <span class="comment"> * values.</span>
<a name="l00351"></a>00351 <span class="comment"> *</span>
<a name="l00352"></a>00352 <span class="comment"> * Newly created attributes are initialized to 0/false.</span>
<a name="l00353"></a>00353 <span class="comment"> *</span>
<a name="l00354"></a>00354 <span class="comment"> * Some attributes are created and set by ccnd, reflecting things about faces</span>
<a name="l00355"></a>00355 <span class="comment"> * that may be relevant to the operation of strategies.  These are assigned</span>
<a name="l00356"></a>00356 <span class="comment"> * with predeclared indices, so it is not necessary to learn the index</span>
<a name="l00357"></a>00357 <span class="comment"> * from the name at runtime (although this is allowed).  All of the built-in</span>
<a name="l00358"></a>00358 <span class="comment"> * single-bit attributes have small indices, and so are accessible using</span>
<a name="l00359"></a>00359 <span class="comment"> * faceattr_get_packed.  Macros for corresponding bit masks are also provided.</span>
<a name="l00360"></a>00360 <span class="comment"> */</span>
<a name="l00361"></a>00361 <span class="keywordtype">int</span> <a class="code" href="ccnd_8c.html#ad1432c22d991a314ea57fe20b76bfb5e" title="Face attributes.">faceattr_index_from_name</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00362"></a>00362 <span class="keywordtype">int</span> <a class="code" href="ccnd_8c.html#a8469ebf26c72700a5fa8f71b6934f7ed">faceattr_bool_index_from_name</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00363"></a>00363 <span class="keywordtype">int</span> <a class="code" href="ccnd_8c.html#a6d853d37e72b01203a548f162dd84843">faceattr_index_allocate</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h);
<a name="l00364"></a>00364 <span class="keywordtype">int</span> <a class="code" href="ccnd_8c.html#a0e76c87a88898bb4e77df4c397f74bd5">faceattr_index_free</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keywordtype">int</span> faceattr_index);
<a name="l00365"></a>00365 <span class="keywordtype">unsigned</span> <a class="code" href="ccnd_8c.html#aa7ded90084f005b7394bf9ee80a73732">faceattr_get</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keyword">struct</span> <a class="code" href="structface.html" title="One of our active faces.">face</a> *<a class="code" href="structface.html" title="One of our active faces.">face</a>, <span class="keywordtype">int</span> faceattr_index);
<a name="l00366"></a>00366 <span class="keywordtype">int</span> <a class="code" href="ccnd_8c.html#a927eea152300430e1fce9fb665608dfd">faceattr_set</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keyword">struct</span> <a class="code" href="structface.html" title="One of our active faces.">face</a> *<a class="code" href="structface.html" title="One of our active faces.">face</a>, <span class="keywordtype">int</span> faceattr_index, <span class="keywordtype">unsigned</span> value);
<a name="l00367"></a>00367 <span class="keywordtype">unsigned</span> <a class="code" href="ccnd_8c.html#a9fcdc86cd4ac31dc19b7efea014bb71d">faceattr_get_packed</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keyword">struct</span> <a class="code" href="structface.html" title="One of our active faces.">face</a> *<a class="code" href="structface.html" title="One of our active faces.">face</a>);
<a name="l00368"></a>00368 <span class="comment"></span>
<a name="l00369"></a>00369 <span class="comment">/**</span>
<a name="l00370"></a>00370 <span class="comment"> *  Face attribute &quot;valid&quot;</span>
<a name="l00371"></a>00371 <span class="comment"> *</span>
<a name="l00372"></a>00372 <span class="comment"> * If true, the face may be used for interest/data exchange.</span>
<a name="l00373"></a>00373 <span class="comment"> */</span>
<a name="l00374"></a><a class="code" href="ccnd__strategy_8h.html#a86d5a3de335119021585b576ec836a0a">00374</a> <span class="preprocessor">#define FAI_VALID 0</span>
<a name="l00375"></a><a class="code" href="ccnd__strategy_8h.html#a722c4b1f55b9c8228abdef11ac1a67bb">00375</a> <span class="preprocessor"></span><span class="preprocessor">#define FAM_VALID (1U &lt;&lt; FAI_VALID)</span>
<a name="l00376"></a>00376 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00377"></a>00377 <span class="comment">/**</span>
<a name="l00378"></a>00378 <span class="comment"> *  Face attribute &quot;application&quot;</span>
<a name="l00379"></a>00379 <span class="comment"> *</span>
<a name="l00380"></a>00380 <span class="comment"> * If true, the face is deemed to be a local application, by virtue of</span>
<a name="l00381"></a>00381 <span class="comment"> * connection information (e.g., loopback interface or unix-domain socket).</span>
<a name="l00382"></a>00382 <span class="comment"> */</span>
<a name="l00383"></a><a class="code" href="ccnd__strategy_8h.html#a1c96734ab8630960a573470406405ccf">00383</a> <span class="preprocessor">#define FAI_APPLICATION 1</span>
<a name="l00384"></a><a class="code" href="ccnd__strategy_8h.html#a3e975dfd3810cabdd4574e34258d5397">00384</a> <span class="preprocessor"></span><span class="preprocessor">#define FAM_APPLICATION (1U &lt;&lt; FAI_APPLICATION)</span>
<a name="l00385"></a><a class="code" href="ccnd__strategy_8h.html#a8f521321534850b9e950acfe6837620b">00385</a> <span class="preprocessor"></span><span class="preprocessor">#define FAM_APP FAM_APPLICATION</span>
<a name="l00386"></a>00386 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00387"></a>00387 <span class="comment">/**</span>
<a name="l00388"></a>00388 <span class="comment"> *  Face attribute &quot;broadcastcapable&quot;</span>
<a name="l00389"></a>00389 <span class="comment"> *</span>
<a name="l00390"></a>00390 <span class="comment"> * If true, the face can reach multiple peers via broadcast.</span>
<a name="l00391"></a>00391 <span class="comment"> */</span>
<a name="l00392"></a><a class="code" href="ccnd__strategy_8h.html#ac0b7fa5ecf8bb949562969833132490b">00392</a> <span class="preprocessor">#define FAI_BROADCAST_CAPABLE 2</span>
<a name="l00393"></a><a class="code" href="ccnd__strategy_8h.html#a5c0319ac816e10db4daa4237c1833c0d">00393</a> <span class="preprocessor"></span><span class="preprocessor">#define FAM_BROADCAST_CAPABLE (1U &lt;&lt; FAI_BROADCAST_CAPABLE)</span>
<a name="l00394"></a><a class="code" href="ccnd__strategy_8h.html#ae131e557f4761e7929f06d2d717a8ebe">00394</a> <span class="preprocessor"></span><span class="preprocessor">#define FAM_BCAST FAM_BROADCAST_CAPABLE</span>
<a name="l00395"></a>00395 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00396"></a>00396 <span class="comment">/**</span>
<a name="l00397"></a>00397 <span class="comment"> *  Face attribute &quot;directcontrol&quot;</span>
<a name="l00398"></a>00398 <span class="comment"> *</span>
<a name="l00399"></a>00399 <span class="comment"> * If true, the face should not be sent interests unless there is no</span>
<a name="l00400"></a>00400 <span class="comment"> * response from any other faces.  This may be used by an application that</span>
<a name="l00401"></a>00401 <span class="comment"> * can update the FIB on demand.</span>
<a name="l00402"></a>00402 <span class="comment"> */</span>
<a name="l00403"></a><a class="code" href="ccnd__strategy_8h.html#adc303e86e33bb24e4f8b18b626efc5ae">00403</a> <span class="preprocessor">#define FAI_DIRECT_CONTROL 3</span>
<a name="l00404"></a><a class="code" href="ccnd__strategy_8h.html#ac62437908020b0867732849cf369ab4b">00404</a> <span class="preprocessor"></span><span class="preprocessor">#define FAM_DIRECT_CONTROL (1U &lt;&lt; FAI_DIRECT_CONTROL)</span>
<a name="l00405"></a><a class="code" href="ccnd__strategy_8h.html#ae95da3bddc050f7a6dce783707af0779">00405</a> <span class="preprocessor"></span><span class="preprocessor">#define FAM_DC FAM_DIRECT_CONTROL</span>
<a name="l00406"></a>00406 <span class="preprocessor"></span><span class="comment"></span>
<a name="l00407"></a>00407 <span class="comment">/**</span>
<a name="l00408"></a>00408 <span class="comment"> *  Stateless enumerator for face attribute names</span>
<a name="l00409"></a>00409 <span class="comment"> *</span>
<a name="l00410"></a>00410 <span class="comment"> * Call with NULL to get the first name.  Returns NULL after the last name.</span>
<a name="l00411"></a>00411 <span class="comment"> * The order is unspecified.  Generated names are provided for private attrs.</span>
<a name="l00412"></a>00412 <span class="comment"> */</span>
<a name="l00413"></a>00413 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="ccnd_8c.html#ac2580d0a00995ce96d373dfa406e2641" title="Stateless enumerator for face attribute names.">faceattr_next_name</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *h, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00414"></a>00414 <span class="comment"></span>
<a name="l00415"></a>00415 <span class="comment">/** For debugging */</span>
<a name="l00416"></a>00416 <span class="keywordtype">void</span> <a class="code" href="ccnd__msg_8c.html#ab366c8b24b40d405717b70124e6049be" title="Produce ccnd debug output.">ccnd_msg</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *, ...);
<a name="l00417"></a>00417 <span class="comment"></span>
<a name="l00418"></a>00418 <span class="comment">/** A PRNG returning 31-bit pseudo-random numbers */</span>
<a name="l00419"></a>00419 uint32_t <a class="code" href="ccnd_8c.html#a4b413f34df4defaf6607bf876a645614" title="A PRNG returning 31-bit pseudo-random numbers.">ccnd_random</a>(<span class="keyword">struct</span> <a class="code" href="structccnd__handle.html" title="We pass this handle almost everywhere within ccnd.">ccnd_handle</a> *);
<a name="l00420"></a>00420 <span class="comment"></span>
<a name="l00421"></a>00421 <span class="comment">/** look up a strategy class */</span>
<a name="l00422"></a>00422 <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structstrategy__class.html">strategy_class</a> *<a class="code" href="ccnd_8c.html#a26344bd0dc6bcc1f2225b8ab0630b266" title="look up a strategy class">strategy_class_from_id</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keywordtype">id</span>);
<a name="l00423"></a>00423 
<a name="l00424"></a>00424 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structstrategy__class.html">strategy_class</a> <a class="code" href="ccnd__strategy_8h.html#a2aaa5325345150a39c3332a763825036">ccnd_strategy_classes</a>[];
<a name="l00425"></a>00425 
<a name="l00426"></a>00426 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 1 2014 10:50:55 for Content-Centric Networking in C by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
